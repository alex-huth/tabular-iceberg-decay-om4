<?xml version="1.0"?>
<!-- FRE Usage documentation: http://www.gfdl.noaa.gov/fms/fre -->
<!--
Quick start guide
This xml consists of 1/4 degree and 1/2 degree Ocean-Ice experiments.

module load fre/bronx-12
fremake -x OMIP4_CORE2.xml -p ncrc4.intel16 -t prod MOM6_SIS2_compile
frerun  -x OMIP4_CORE2.xml -p ncrc4.intel16 -t prod OM4p125_IAF_csf_CORE2_r5 -r basic 
-->

<experimentSuite rtsVersion="4" xmlns:xi="http://www.w3.org/2001/XInclude">
  <property name="RELEASE"        value="warsaw_201803"/>           <!-- git tag for general component source code-->
  <property name="SHARED_GIT_TAG" value="$(RELEASE)"/>              <!-- git tag for shared source code -->
  <property name="OCEAN_SHARED_GIT_TAG" value="dev/esm4/20180208"/> <!-- git tag for ocean_shared source code -->
  <property name="MOM6_DATE"      value="OMIP1_v1.0.0"/>              <!-- git tag date for MOM6 source code -->
  <property name="MOM6_GIT_TAG"   value="OMIP1/v1.0.0"/>              <!-- git tag for MOM6 source code -->
  <property name="FRE_STEM"       value="$(RELEASE)_mom6_$(MOM6_DATE)"/> <!-- customize as needed -->
  <!-- Please make sure to change "YOURGROUPLETTER" to your group, such as b, f, g, m, o... -->
  <property name="GFDL_GROUP"     value="gfdl_f"/><!-- Replace YOURGROUPLETTER with GFDL group letter -->

  <property name="OM4_ANALYSIS" value="ice_ocean_SIS2/OM4_05"/>  <!--example containing .frepp scripts for analysis-->

   <!--Production run properties. Users can modify these according to their need and/or performance analysis-->
   <property name="PROD_SIMTIME"   value="5"/>
   <!--Post-processing  chunk lengths -->
   <property name="CHUNK_LENGTH_A" value="5yr"/>
   <property name="CHUNK_LENGTH_B" value="20yr"/>
   <!--Start year of PP -->
   <property name="PP_START_YEAR"  value="1708"/>      <!--Use these values for CORE2 dynamic forcing runs -->
   <property name="FRE_VERSION"     value="bronx-15"/> <!-- fre version to be used -->
   <property name="ProjectID"       value="CMIP6"/>      <!-- database top level -->
   <property name="ANALYSIS_SWITCH" value="on"/>       <!-- on/off switch for ATM/LND analysis -->
   <property name="MDBIswitch"      value="off"/>       <!-- on/off switch for MDBI database -->
   <!--The following properties need to be set only if the user wants to monitor the run progress at MDBI
             and are not needed for the run or post-processing -->
   <property name="EXP_CPLD_START"   value="1708"/> <!--simulation start year-->
   <property name="EXP_CPLD_END"     value="2007"/> <!--simulation end   year-->

   <!--Users need not change the following properties -->
   <property name="reference_tag"  value="warsaw_201803_mom6_2018.04.11"/> <!-- Reference release tag for existing files in the archives for answer comparison. Used in "REFERENCE" property. -->

   <!-- The following properties are for testing/debugging purposes and should normally be empty-->
   <property name="MODIFIER"     value=""/>  
   <property name="DEBUGLEVEL"   value=""/>
   <property name="STATIC"       value=""/>  
  <property name="KRASTING"   value="/lustre/f2/dev/John.Krasting"/>

  <property name="PLATINFO"   value=""/>  <!--This is necessary only if you want to run exact same experiment on multiple platforms-->
  <property name="AWG_INPUT_HOME_GAEA"  value="awg_include"/>
  <property name="AWG_INPUT_HOME_GFDL"  value="/nbhome/$USER/$(FRE_STEM)$(PLATINFO)/$(name)/mdt_xml/awg_include"/>
  <property name="append_to_setup_csh"  value=""/>
  
  <setup>
    <xi:include href="awg_include/xml_building_blocks/platforms.xml" xpointer="xpointer(//freInclude/platform[@name='ncrc4.intel16'])"/>
    <xi:include href="awg_include/xml_building_blocks/platforms.xml" xpointer="xpointer(//freInclude/platform[@name='ncrc3.intel16'])"/>
    <xi:include href="awg_include/xml_building_blocks/platforms.xml" xpointer="xpointer(//freInclude/platform[@name='gfdl.ncrc4-intel16'])"/>
    <xi:include href="awg_include/xml_building_blocks/platforms.xml" xpointer="xpointer(//freInclude/platform[@name='gfdl.ncrc3-intel16'])"/>
  </setup>


  <freInclude name="resourceparams_O9084p125_production">
	     <resources jobWallclock="14:00:00"  segRuntime="7:00:00">
               <ocn ranks="9084" layout = "120,112"   io_layout = "4,4" mask_table="mask_table.4356.120x112" threads="1"/>
               <ice              layout = "120,112"   io_layout = "4,4" mask_table="mask_table.4356.120x112"/>
             </resources>
  </freInclude>

  <freInclude name="resourceparams_O4671_production">
           <resources jobWallclock="16:00:00"  segRuntime="3:00:00">
             <ocn ranks="4671" layout = "90,72"   io_layout = "1,4" mask_table="mask_table.1809.90x72" threads="1"/>
             <ice              layout = "90,72"   io_layout = "1,4" mask_table="mask_table.1809.90x72"/>
           </resources>
  </freInclude>

  <freInclude name="resourceparams_O1057p5_production">
             <resources jobWallclock="16:00:00"  segRuntime="5:00:00">
	       <ocn ranks="1057" layout = "36,36"   io_layout = "1,4" mask_table="mask_table.239.36x36" threads="1"/>
	       <ice              layout = "36,36"   io_layout = "1,4" mask_table="mask_table.239.36x36"/>
             </resources>
   </freInclude>
  <freInclude name="resourceparams_O1300p5_production">
             <resources jobWallclock="16:00:00"  segRuntime="4:00:00">
               <ocn ranks="1300" layout = "36,45"   io_layout = "1,5" mask_table="mask_table.320.36x45" threads="1"/>
               <ice              layout = "36,45"   io_layout = "1,5" mask_table="mask_table.320.36x45"/>
             </resources>
   </freInclude>
   <freInclude name="resourceparams_O2783p5_production">
	     <resources jobWallclock="16:00:00"  segRuntime="2:00:00">
	       <ocn ranks="2783" layout = "60,60"   io_layout = "1,5" mask_table="mask_table.817.60x60" threads="1"/>
	       <ice              layout = "60,60"   io_layout = "1,5" mask_table="mask_table.817.60x60"/>
	     </resources>
   </freInclude>


<!--= COMPILE =-->
<!--===========-->
  <!--The property MOM6_EXAMPLES should point to the mom6 directory that is checked out. It is needed by MOM6 to access its input data files-->
   <property name="PROG_MAIN"   value="coupler/coupler_main.o"/>
   <property name="LIBS_ROOT"   value="MOM6_SIS2_compile"/>
   <property name="FMS_LIB_DIR" value="./$(LIBS_ROOT)/$(platform)-$(target)/exec"/>
   
   <property name="MOM6_EXAMPLES"  value="$root/$(LIBS_ROOT)/src/mom6"/>
   <property name="MY_LIBS"        value="$(EXEC_ROOT)/$(FMS_LIB_DIR)"/>

  <property name="gfdlO_pdata"  value="/lustre/f2/pdata/gfdl/gfdl_O"/>

   <experiment name="MOM6_SIS2_compile">
      <description>
Make the executable for ocean-ice experiments.
      </description>
      <component name="fms" paths="FMS/amip_interp FMS/column_diagnostics FMS/fft FMS/horiz_interp FMS/memutils FMS/oda_tools FMS/sat_vapor_pres FMS/topography FMS/astronomy FMS/constants  FMS/diag_manager FMS/field_manager FMS/include FMS/platform FMS/station_data FMS/tracer_manager FMS/axis_utils FMS/coupler FMS/drifters FMS/fms FMS/interpolator FMS/mosaic FMS/random_numbers FMS/time_interp FMS/tridiagonal FMS/block_control  FMS/data_override       FMS/exchange  FMS/fv3gfs  FMS/mpp FMS/time_manager">
     <description domainName="infrastructure" communityName="FMS" communityVersion="$(RELEASE)" communityGrid=""/>
     <source versionControl="git" root="https://github.com/NOAA-GFDL">
            <codeBase version="$(RELEASE)"> FMS.git </codeBase>
      	    <csh><![CDATA[
              ( cd FMS && git checkout $(SHARED_GIT_TAG) )
              ]]>
            </csh>
     </source>
     <compile>
        <cppDefs>-Duse_libMPI -Duse_netCDF $(F2003_FLAGS) -DMAXFIELDMETHODS_=400</cppDefs>
     </compile>
    </component>

    <component name="mom6" requires="fms" paths="mom6/src/MOM6/config_src/dynamic mom6/src/MOM6/config_src/coupled_driver mom6/src/MOM6/src/*/ mom6/src/MOM6/src/*/*/ ocean_shared/generic_tracers ocean_shared/mocsy/src">
      <description domainName="Ocean" communityName="GFDL-MOM6" communityVersion="$(MOM6_GIT_TAG)" communityGrid="Tripolar"/>
       <source versionControl="git" root="http://gitlab.gfdl.noaa.gov/fms">
        <codeBase version="$(OCEAN_SHARED_GIT_TAG)"> ocean_shared.git </codeBase>
        <csh><![CDATA[
          git clone -b $(MOM6_GIT_TAG) https://github.com/NOAA-GFDL/MOM6-examples.git mom6
          pushd mom6
          git checkout $(MOM6_GIT_TAG)  #needed for older git on zeus
          git submodule init src/MOM6 src/SIS2 src/icebergs tools/python/MIDAS
          git clone --recursive https://github.com/NOAA-GFDL/MOM6.git src/MOM6 
          git clone             https://github.com/NOAA-GFDL/SIS2.git src/SIS2
          git clone             https://github.com/NOAA-GFDL/icebergs.git src/icebergs
          git submodule update #This gets the right version of submodules

          set platform_domain = `perl -T -e "use Net::Domain(hostdomain) ; print hostdomain"`
          if ("${platform_domain}" =~ *"fairmont.rdhpcs.noaa.gov"* ) then
            ln -s /scratch4/GFDL/gfdlscr/pdata/gfdl_O/datasets/ .datasets
          else if ("${platform_domain}" =~ *"ccs.ornl.gov"* ) then
            ln -s /lustre/atlas/proj-shared/cli061/pdata/gfdl_O/datasets/ .datasets
          else
            ln -s /lustre/f2/pdata/gfdl/gfdl_O/datasets/ .datasets
          endif
          popd	  

          test -e mom6/.datasets
          if ($status != 0) then
            echo ""; echo "" ; echo "   WARNING:  .datasets link in MOM6 examples directory is invalid"; echo ""; echo ""
          endif
 
        ]]></csh>
      </source>
      <compile>
        <cppDefs><![CDATA[ $(F2003_FLAGS) -DMAX_FIELDS_=100 -DNOT_SET_AFFINITY -D_USE_MOM6_DIAG -D_USE_GENERIC_TRACER  -DUSE_PRECISION=2 -D_FILE_VERSION="'"`git-version-string $<`"'" ]]></cppDefs>
        <makeOverrides>OPENMP=""</makeOverrides> <!-- openmp switch for MOM6 may cause crash -->
      </compile>
    </component>
      
      <component name="icebergs" paths="mom6/src/icebergs" requires="fms">
       <source versionControl="git" root="http://gitlab.gfdl.noaa.gov/fms">
        <codeBase version="master"> ocean_null.git </codeBase>
        <csh>\rm -rf ocean_null</csh>
       </source>
       <compile>
            <cppDefs><![CDATA[-D_FILE_VERSION="'"`git-version-string $<`"'"]]> </cppDefs>
       </compile>
       <description domainName="N/A" communityName="N/A" communityVersion="$(RELEASE)" communityGrid="N/A"/>
      </component>


      <component name="sis2" paths="mom6/src/SIS2/config_src/dynamic_symmetric mom6/src/SIS2/src ice_param" requires="fms mom6 icebergs" includeDir="$root/$(LIBS_ROOT)/src/mom6/src/MOM6/src/framework" > 
         <description domainName="Sea Ice SIS2" communityName="GFDL-SIS2" communityVersion="$(RELEASE)" communityGrid="Tripolar"/>
         <source versionControl="git" root="http://gitlab.gfdl.noaa.gov/fms">
	   <codeBase version="$(RELEASE)"> ice_param.git </codeBase> 
         </source>
         <compile>
            <cppDefs><![CDATA[$(F2003_FLAGS) -D_FILE_VERSION="'"`git-version-string $<`"'"]]></cppDefs>
<!--            <makeOverrides>OPENMP=""</makeOverrides> openmp switch for MOM6 may cause crash -->
         </compile>
      </component>

      <component name="land_null" paths="land_null" requires="fms">
         <description domainName="NA" communityName="NA" communityVersion="NA" communityGrid="NA"/>
         <source versionControl="git" root="http://gitlab.gfdl.noaa.gov/fms">
            <codeBase version="$(RELEASE)"> land_null.git </codeBase>
         </source>
      </component>

      <component name="atmos_null" paths="atmos_null atmos_param/monin_obukhov atmos_param/diag_integral" requires="fms">
         <source versionControl="git" root="http://gitlab.gfdl.noaa.gov/fms">
           <codeBase version="$(RELEASE)"> atmos_null.git atmos_param.git </codeBase>
         </source>
         <compile>
            <cppDefs>$(F2003_FLAGS) </cppDefs>
        </compile>
      </component>
      <component name="FMScoupler" paths="FMScoupler" requires="fms land_null atmos_null sis2 mom6 icebergs">
        <description domainName="FMS Coupler" communityName="coupler" communityVersion="$(RELEASE)" communityGrid=""/>  
        <source versionControl="git" root="https://github.com/NOAA-GFDL">
          <codeBase version="$(RELEASE)"> coupler.git </codeBase>
        </source>
        <compile>
            <cppDefs><![CDATA[$(F2003_FLAGS) -D_USE_LEGACY_LAND_ -Duse_AM3_physics -D_FILE_VERSION="'"`git-version-string $<`"'"]]></cppDefs>
        </compile>
      </component>
<!-- post xanadu
      <component name="coupler" paths="coupler/shared coupler/full" requires="fms land_null atmos_null sis2 mom6 icebergs">
        <description domainName="FMS Coupler" communityName="coupler" communityVersion="$(RELEASE)" communityGrid=""/>  
        <source versionControl="git" root="https://github.com/NOAA-GFDL">
          <codeBase version="$(RELEASE)"> coupler.git </codeBase>
        </source>
        <compile>
            <cppDefs><![CDATA[$(F2003_FLAGS) -D_USE_LEGACY_LAND_ -Duse_AM3_physics -D_FILE_VERSION="'"`git-version-string $<`"'"]]></cppDefs>
        </compile>
      </component>
-->
   </experiment>

   <freInclude name="OM4_common">
    <input>
     <csh type="always">
        <![CDATA[
#------------------------------------------
## Find out whether to restart.

if ( $currentSeg == 1 ) then
   set restart_flag = 'n'
else
   set restart_flag = 'r'
   #Because of a technical issue FRE does not delete old uncombined restarts before copying the new ones for the next segment
   #The INPUT/ ends up with inconsistent restart files which at best cause the model to crash right away.
   if(-e $work/INPUT/MOM.res.nc.0000 ) \rm -rf $work/INPUT/MOM.res*.nc
endif

ln -s $work/INPUT/ocean_topog.nc $work/INPUT/topog.nc 

touch $work/INPUT/MOM_override
touch $work/INPUT/SIS_override
touch $work/INPUT/MOM_layout
touch $work/INPUT/SIS_layout

# Record the job stdout location for later use timings database
cat >> $HOME/frejobs_stdout <<EOF_frejobs
$stdoutDir/$FRE_JOBID
EOF_frejobs



cat > $work/INPUT/MOM_layout << MOM_LAYOUT_EOF
#override IO_LAYOUT = $ocn_io_layout
#override LAYOUT    = $ocn_layout
#override MASKTABLE = $ocn_mask_table
#override OCEAN_OMP_THREADS = $ocn_threads
MOM_LAYOUT_EOF

cat > $work/INPUT/SIS_layout << SIS_LAYOUT_EOF
#override IO_LAYOUT = $ice_io_layout
#override LAYOUT    = $ice_layout
#override MASKTABLE = $ice_mask_table
SIS_LAYOUT_EOF

cat > $work/INPUT/SIS_diurnal << SIS_diurnal_EOF
ADD_DIURNAL_SW = True ! This must ONLY be used in the ice-ocean mode if forcing is not diurnal (e.g. CORE), NOT fully coupled mode.
SIS_diurnal_EOF

# Copy AWG and OWG ascii input files to GFDL (waiting for FRE to do this for us)
if ( $?flagOutputXferOn && $?flagOutputPostProcessOn && $currentSeg == 1 ) then
  #gcp --batch does not understand some variations of home filesystem like /autofs/mnt/ncrc-svm1_home1 so we need to massage rtsxml to comply
  set xmldirlocal = `dirname $rtsxml | sed -r "s/^\/(autofs|ncrc)\/.+\/$USER\//\~$USER\//"`
  set xmldirRemote = `echo $xmldirlocal | sed -r "$patternSedHome"`
  set platform_domain = `perl -T -e "use Net::Domain(hostdomain) ; print hostdomain"`
  if ("${platform_domain}" == "ncrc.gov") then
    set xmldirRemote = `echo $xmldirlocal | sed -r "$patternSedHome;$patternSedCTMP;$patternSedCPERM"`
    gcp --batch -cd -r --sync $xmldirlocal/awg_include gfdl:$(NB_ROOT)/mdt_xml/
    gcp --batch -cd -r --sync $xmldirlocal/awg_include gfdl:$xmldirRemote/
  endif
  #trick to copy MOM6 directory but avoid traversing the .datasets links
  tar cvf mom6.tar --exclude='.datasets' -C $(MOM6_EXAMPLES) . > /dev/null
  mkdir mom6
  tar xvf mom6.tar -C ./mom6 > /dev/null
  if ("${platform_domain}" == "ncrc.gov") then
    gcp --batch -cd -r --sync mom6 gfdl:$(NB_ROOT)/
  else if ("${platform_domain}" =~ *"fairmont.rdhpcs.noaa.gov"* ) then
    gcp -cd -r --sync mom6 gfdl:$(NB_ROOT)/
  endif
endif


      ]]></csh>
    </input>
   </freInclude>

   <freInclude name="CORE2_data_table">
    <input>
      <dataTable>
"ATM" , "p_surf"        , "SLP"         , "./INPUT/slp.1948-2007.nomads.nc"          , "bilinear" ,  1.0
"ATM" , "p_bot"         , "SLP"         , "./INPUT/slp.1948-2007.nomads.nc"          , "bilinear" ,  1.0
"ATM" , "t_bot"         , "T_10_MOD"    , "./INPUT/t_10_mod.1948-2007.nomads.nc"     , "bilinear" ,  1.0
"ATM" , "sphum_bot"     , "Q_10_MOD"    , "./INPUT/q_10_mod.1948-2007.nomads.nc"     , "bilinear" ,  1.0
"ATM" , "u_bot"         , "U_10_MOD"    , "./INPUT/u_10_mod.1948-2007.nomads.nc"     , "bicubic",   1.0
"ATM" , "v_bot"         , "V_10_MOD"    , "./INPUT/v_10_mod.1948-2007.nomads.nc"     , "bicubic",   1.0
"ATM" , "z_bot"         , ""            , ""                                         , "bilinear" , 10.0
"ATM" , "gust"          , ""            , ""                                         , "bilinear" ,  1.0e-4
"ICE" , "lw_flux_dn"    , "LWDN_MOD"    , "./INPUT/ncar_rad.1948-2007.nomads.nc"     , "bilinear" ,  1.0
"ICE" , "sw_flux_vis_dir_dn", "SWDN_MOD", "./INPUT/ncar_rad.1948-2007.nomads.nc"     , "bilinear" ,  0.285
"ICE" , "sw_flux_vis_dif_dn", "SWDN_MOD", "./INPUT/ncar_rad.1948-2007.nomads.nc"     , "bilinear" ,  0.285
"ICE" , "sw_flux_nir_dir_dn", "SWDN_MOD", "./INPUT/ncar_rad.1948-2007.nomads.nc"     , "bilinear" ,  0.215
"ICE" , "sw_flux_nir_dif_dn", "SWDN_MOD", "./INPUT/ncar_rad.1948-2007.nomads.nc"     , "bilinear" ,  0.215
"ICE" , "lprec"         , "RAIN"        , "./INPUT/ncar_precip.1948-2007.nomads.nc"  , "bilinear" ,  0.9933
"ICE" , "fprec"         , "SNOW"        , "./INPUT/ncar_precip.1948-2007.nomads.nc"  , "bilinear" ,  0.9933
"ICE" , "calving"       , ""            , ""                             , "none"  ,  0.0
"ICE" , "dhdt"          , ""            , ""                             , "none"  , 80.0
"ICE" , "dedt"          , ""            , ""                             , "none"  ,  2.0e-6
"ICE" , "drdt"          , ""            , ""                             , "none"  ,  10.0
"LND" , "t_surf"        , ""            , ""                             , "none"  ,  273.0
"LND" , "t_ca"          , ""            , ""                             , "none"  ,  273.0
"LND" , "q_ca"          , ""            , ""                             , "none"  ,  0.0
"LND" , "rough_mom"     , ""            , ""                             , "none"  ,  0.01
"LND" , "rough_heat"    , ""            , ""                             , "none"  ,  0.1
"LND" , "albedo"        , ""            , ""                             , "none"  ,  0.1
#"LND" , "t_ca"         , ""            , ""                             , "none"  ,  273.0
#"LND" , "t_surf"       , ""            , ""                             , "none"  ,  273.0
"LND" , "sphum_surf"    , ""            , ""                             , "none"  ,  0.0
"LND" , "sphum_ca"      , ""            , ""                             , "none"  ,  0.0
"LND" , "t_flux"        , ""            , ""                             , "none"  ,  0.0
"LND" , "sphum_flux"    , ""            , ""                             , "none"  ,  0.0
"LND" , "lw_flux"       , ""            , ""                             , "none"  ,  0.0
"LND" , "sw_flux"       , ""            , ""                             , "none"  ,  0.0
"LND" , "lprec"         , ""            , ""                             , "none"  ,  0.0
"LND" , "fprec"         , ""            , ""                             , "none"  ,  0.0
"LND" , "dhdt"          , ""            , ""                             , "none"  ,  5.0
"LND" , "dedt"          , ""            , ""                             , "none"  ,  2e-6
"LND" , "dedq"          , ""            , ""                             , "none"  ,  0.0
"LND" , "drdt"          , ""            , ""                             , "none"  ,  5.0
"LND" , "drag_q"        , ""            , ""                             , "none"  ,  0.0
"LND" , "p_surf"        , ""            , ""                             , "none"  ,  1.e5
      </dataTable>
    </input>
   </freInclude>
   

   <!--****************************************************************************************-->
   <!--***************************** 1/8 degree experiments        ****************************-->
   <!--****************************************************************************************-->
						
   <experiment name="OM4p125_IAF_csf_CORE2_r5" inherit="MOM6_SIS2_compile$(MODIFIER)">
    <description>
global 1/8 degree z ocean_ice experiment 
regridded runoff and salinity
CORE2 dynamic inter_annual forcing data
Using the same MOM6/SIS2 timesteps as JRA runs
Use downsampled diagnostics _d2
ADJUST_NET_FRESH_WATER_TO_ZERO  = True
READ_TIDEAMP = True
#override KAPPA_H2_FACTOR = 2.8  ! increase from 0.84 recommended by Matt
    </description>  
    <publicMetadata DBswitch="$(MDBIswitch)">
      <!-- Realization tag -->
      <realization r="1" i="1" p="1" f="1"/>
      <!-- project info -->
      <project>CMIP6</project>
      <activity_id>OMIP</activity_id>
      <mip_era>CMIP6</mip_era>
      <!-- model info -->
      <!-- the model names are subject to change after arriving at a new name and registering it in CV-->	
      <source>GFDL-OM4_p125deg_CORE2 (2017)</source>
      <source_id>GFDL-OM4_p125deg_CORE2</source_id>
      <source_type>OGCM</source_type>
      <!--experiment info-->
      <experiment_name>OMIP experiment forced by CORE Inter-Annual Forcing (CIAF) version 2.0 and initialized with observed physical and biogeochemical ocean data</experiment_name>
      <experiment_id>omip2</experiment_id>
      <sub_experiment>none</sub_experiment>
      <sub_experiment_id>none</sub_experiment_id>
      <start_time>$(EXP_CPLD_START)</start_time>
      <end_time>$(EXP_CPLD_END)</end_time>
      <!-- branch info -->
      <branch_method>standard</branch_method>
      <branch_time_in_child>0.0D0</branch_time_in_child>
      <branch_time_in_parent></branch_time_in_parent>
      <!-- variant info-->
      <variant_info></variant_info>
      <!--parent info-->
      <parent_time_units>days since 1708-1-1</parent_time_units>
      <parent_activity_id>CMIP</parent_activity_id>
      <parent_experiment_id></parent_experiment_id>
      <parent_mip_era>CMIP6</parent_mip_era>
      <parent_source_id>GFDL-OM4</parent_source_id>
      <parent_variant_label>r1i1p1f1</parent_variant_label>
      <comment>
       Experiment name = $(name)
    For more information please refer to the
    &lt;a href="https://github.com/NOAA-GFDL/MOM6-examples/wiki"&gt; MOM6 Wiki.  &lt;/a&gt;
      </comment>

    </publicMetadata>
    <input>
      <namelist name="coupler_nml">
       months = $months,
       days   = $days,
       current_date = 1708,1,1,0,0,0,
       hours = 0
       minutes = 0
       seconds = 0
       calendar = 'NOLEAP',
       dt_cpld  = 3600,
       dt_atmos = 3600,
       do_atmos = .false.,
       do_land = .false.,
       do_ice = .true.,
       do_ocean = .true.,
       atmos_npes = 0,
       ocean_npes = 0,
       concurrent = .false.
       use_lag_fluxes=.false. 
       atmos_nthreads = $atm_threads
       ocean_nthreads = $ocn_threads
     </namelist>
     <namelist name="xgrid_nml">
       make_exchange_reproduce = .true.
       interp_method = 'second_order'
     </namelist>
     <namelist name="fms_nml">
       clock_grain='ROUTINE'
       clock_flags='NONE'
       domains_stack_size = 8000000
       stack_size =0
     </namelist>
     <namelist name="fms_io_nml" >
       fms_netcdf_restart=.true.
       threading_read='multi'
       max_files_r = 800
       max_files_w = 800
     </namelist>
     <namelist name="atmos_model_nml" >
       layout= 0, 0
     </namelist>
     <!--verona-->
     <namelist name="sat_vapor_pres_nml">
      construct_table_wrt_liq = .true.,
      construct_table_wrt_liq_and_ice = .true.,
     </namelist>
   
     <dataFile label="namelist" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/input.nml</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/input.nml</dataSource>
     </dataFile>

     <!--common setup-->
      <xi:include xpointer="xpointer(//freInclude[@name='OM4_common']/input/node())"/>
      <!--OM4 gridSpec mosaic datasets-->
      <xi:include xpointer="xpointer(//freInclude[@name='OM4p125_grid']/input/node())"/>
      <!--MOM6 Input datasets-->
      <xi:include xpointer="xpointer(//freInclude[@name='OM4p125_data']/input/node())"/>
      <!--SIS2 Input datasets-->
      <xi:include xpointer="xpointer(//freInclude[@name='SIS2p125_data']/input/node())"/>

     <!--diag_tables-->

     <diagTable>
$name
$baseDate
"ice_month",              1, "months", 1, "days", "time"
"ice_model", "EXT",        "EXT",          "ice_month", "all", "mean", "none", 2
"ice_model", "siu",        "siu",          "ice_month", "all", "mean", "none", 2
"ice_model", "siv",        "siv",          "ice_month", "all", "mean", "none", 2
"ice_model", "siconc",     "siconc",       "ice_month", "all", "mean", "none", 2
"ice_model", "sisnconc",   "sisnconc",     "ice_month", "all", "mean", "none", 2
"ice_model", "simass",     "simass",       "ice_month", "all", "mean", "none", 2
"ice_model", "sisnmass",   "sisnmass",     "ice_month", "all", "mean", "none", 2
"ice_model", "sisnthick",  "sisnthick",    "ice_month", "all", "mean", "none", 2
"ice_model", "sithick",    "sithick",      "ice_month", "all", "mean", "none", 2
"ice_model", "sivol",      "sivol",        "ice_month", "all", "mean", "none", 2
"ice_model", "MIB",        "MIB",          "ice_month", "all", "mean", "none", 2
"ocean_annual",               12, "months",   1, "days", "time"
"ocean_model",   "TKE_tidal",        "TKE_tidal",          "ocean_annual",   "mean", "none", "none",2
"ocean_model",   "TKE_itidal",       "TKE_itidal",         "ocean_annual",   "mean", "none", "none",2
     </diagTable>

     <!--A set of downsampled diagnotics-->
     <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.MOM6.d2sample</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/diag_table.MOM6.d2sample</dataSource>
     </dataFile>

     <!--data_tables and data files-->
     <!--CORE2 forcing-->
     <xi:include xpointer="xpointer(//freInclude[@name='CORE2_data_table']/input/node())"/>
     <!--append the resolution dependent runoff override-->
     <dataTable order="append"> 
#CORE2 runoff    
"ICE" , "runoff"        , "runoff"      , "./INPUT/runoff.daitren.clim.2880x2240.v20180716.nc", "none" ,  1.0
     </dataTable>
     <xi:include xpointer="xpointer(//freInclude[@name='CORE2_IAF_data']/input/node())"/>

      
     <!--field_tables-->
     <dataFile label="fieldTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/field_table</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/field_table</dataSource>
     </dataFile>

     <!--MOM_overrides-->
     <csh>
        <![CDATA[
cat > $work/INPUT/MOM_override << MOM_OVERRIDE_EOF
#override NIGLOBAL = 2880
#override NJGLOBAL = 2240
#override TOPO_EDITS_FILE = ""
#override TIDEAMP_FILE = "tidal_amplitude.v20181107.nc"
#override KAPPA_H2_FACTOR = 2.8  ! increase from 0.84 recommended by Matt
#override CHL_FILE = "seawifs-clim-1997-2010.2880x2240.v20180716.nc"
#override SALT_RESTORE_FILE = "salt_restore_PHC2.2880x2240.v20180716.nc"
#override DT = 300.0                      !   [s] !reduced from 900.0 for OM4_025
#override DT_THERM = 3600.0               !   [s] !reduced from 7200.0 for OM4_025
#override BAD_VAL_SST_MIN = -5.0  ! decreased from default of -3.0 to avoid extremes in 1/8 degree model
#override U_TRUNC_FILE = "MOM_U_truncations"
#override V_TRUNC_FILE = "MOM_V_truncations"
MOM_OVERRIDE_EOF

cat > $work/INPUT/SIS_override << SIS_OVERRIDE_EOF
#override NIGLOBAL = 2880
#override NJGLOBAL = 2240
#override DT_ICE_DYNAMICS = 450 !reduced from 1200.0 for OM4_025
#override DT_RHEOLOGY = 25.0
#override U_TRUNC_FILE = "SIS_U_truncations"
#override V_TRUNC_FILE = "SIS_V_truncations"
SIS_OVERRIDE_EOF

     ]]></csh>

   </input>

    <runtime>   
      <production simTime="$(PROD_SIMTIME)" units="years">
          <segment simTime="12" units="months"/>
          <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_O9084p125_production']/node())"/>
      </production>
      <regression name="basic">
        <run months="1" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O2085p125']/node())"/> </run>
      </regression>
      <regression name="rts">
        <run days="15 16" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O2085p125']/node())"/> </run>
        <run months="1" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O2880']/node())"/> </run>
         <run days="2" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O2240']/node())"/> </run>
         <run days="2" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O4032']/node())"/> </run>
      </regression>
      <regression name="debug">
        <run days="2" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1600']/node())"/> </run>
      </regression>
      <regression name="2days">
        <run days="2" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O9084p125']/node())"/> </run>

      </regression>
    </runtime>

    <postProcess>
      <xi:include xpointer="xpointer(//freInclude[@name='OM4p125_postprocess']/postProcess/node())"/>
    </postProcess>
   </experiment>

   <freInclude name="OM4p125_grid">
    <input>
      <dataFile label="gridSpec" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/tripolar_disp_res8_grid_data.tar</dataSource>
        <dataSource site="gfdl">/archive/Niki.Zadeh/input/xanadu/OM4p125_grid/tripolar_disp_res8_grid_data.tar</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/mask_table.1194.64x64
$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/mask_table.1535.72x72
$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/mask_table.1971.90x72
$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/mask_table.245.32x32
$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/mask_table.795.72x40
$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/mask_table.2534.90x90
$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/mask_table.2837.100x90
$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/mask_table.3150.100x100
$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/mask_table.3830.120x100
$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/mask_table.4356.120x112
$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/mask_table.4668.120x120
$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/mask_table.5927.180x100
$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/mask_table.6368.160x120
      </dataFile>
    </input>
   </freInclude>
   <freInclude name="OM4p125_data">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <!--The following is a copy of /lustre/f1/unswept/Matthew.Harrison/MOM6_datasets/GIS_0125/tikal/tidal_amplitude.nc -->
       <dataSource platform="$(platform)">$(ARCHIVE_NNZ)/input/xanadu/OM4p125_grid/tidal_amplitude.v20181107.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/MOM_input</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/layer_coord.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/MOM_saltrestore</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/MOM_channels_global_025</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/vgrid_75_2m.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/vgrid_75_2m_575m.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/hycom1_75.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/hycom1_75_800m.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/analysis_vgrid_lev35.v1.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/Faroe_edits.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/Faroe_GS_edits.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/All_edits.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/woa13_decav_ptemp_monthly_fulldepth_01.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/woa13_decav_s_monthly_fulldepth_01.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/geothermal_davies2013_v1.nc</dataSource>
      </dataFile>

      <namelist name="MOM_input_nml" >
         output_directory = './',
         input_filename = '$restart_flag'
         restart_input_dir = 'INPUT/',
         restart_output_dir = 'RESTART/',
         parameter_filename = 'INPUT/MOM_input','INPUT/MOM_layout','INPUT/MOM_saltrestore','INPUT/MOM_override'
     </namelist>

     </input>

   </freInclude>

   <freInclude name="SIS2p125_data">
    <input>
     <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/SIS_input</dataSource>
     </dataFile>

     <namelist name="SIS_input_nml" >
         output_directory = './',
         input_filename = '$restart_flag'
         restart_input_dir = 'INPUT/',
         restart_output_dir = 'RESTART/',
         parameter_filename = 'INPUT/SIS_input','INPUT/SIS_layout','INPUT/SIS_diurnal','INPUT/SIS_override'
     </namelist>
     </input>
   </freInclude>
   
   <!--****************************************************************************************-->
   <!--***************************** 1/4 degree experiments        ****************************-->
   <!--****************************************************************************************-->
											      
   <experiment name="OM4p25_IAF_BLING_csf_rerun_hifreqdiag_2003-2008" inherit="OM4p25_IAF_BLING_csf_rerun">
    <input>								      
     <!--There is  MOM6/SIS2 restart provided in initCond.-->
     <namelist name="MOM_input_nml" >
         output_directory = './',
         input_filename = 'r'
         restart_input_dir = 'INPUT/',
         restart_output_dir = 'RESTART/',
         parameter_filename = 'INPUT/MOM_input','INPUT/MOM_layout','INPUT/MOM_override','INPUT/MOM_saltrestore'
     </namelist>
     <namelist name="SIS_input_nml" >
         output_directory = './',
         input_filename = 'r'
         restart_input_dir = 'INPUT/',
         restart_output_dir = 'RESTART/',
         parameter_filename = 'INPUT/SIS_input','INPUT/SIS_layout','INPUT/SIS_override','INPUT/SIS_diurnal'
     </namelist>
     <dataFile label="initCond" target="INPUT/" chksum="" size="" timestamp="">
      <dataSource platform="$(platform)">/lustre/f2/dev/Niki.Zadeh/archive/input/warsaw/OM4p25_IAF_BLING_csf_rerun_restart_20030101_combined.tar</dataSource>
     </dataFile>

     <diagTable>
$name
$baseDate
#
"ice_5daily",    5, "days", 1, "days", "time"
"ice_model", "siconc",  "siconc"    "ice_5daily", "all", "none", "none", 2
"ice_model", "sisnconc","sisnconc", "ice_5daily", "all", "none", "none", 2
"ice_model", "MIB"     ,"MIB",      "ice_5daily", "all", "none", "none", 2
#
"ocean_5daily",  5, "days", 1, "days", "time"
"ocean_model",   "zos",              "zos",                "ocean_5daily",         "all", "none", "none",2
"ocean_model",   "thetao",           "thetao",             "ocean_5daily",         "all", "none", "none",2
"ocean_model",   "so",               "so",                 "ocean_5daily",         "all", "none", "none",2
"ocean_model",   "vintage",          "vintage",            "ocean_5daily",         "all", "none", "none",2
"ocean_model",   "uh",               "uh",                 "ocean_5daily",         "all", "none", "none",2
"ocean_model",   "vh",               "vh",                 "ocean_5daily",         "all", "none", "none",2
"ocean_model",   "e",                "e",                  "ocean_5daily",         "all", "none", "none",2
"ocean_model",   "MLD_003",          "MLD_003",            "ocean_5daily",         "all", "none", "none",2
"ocean_model",   "tauuo",            "tauuo",              "ocean_5daily",         "all", "none", "none",2
"ocean_model",   "tauvo",            "tauvo",              "ocean_5daily",         "all", "none", "none",2
"ocean_model",   "net_heat_coupler", "net_heat_coupler",   "ocean_5daily",         "all", "none", "none",2
"ocean_model",   "Kd_interface",     "Kd_interface",       "ocean_5daily",         "all", "none", "none",2
     </diagTable>
    </input>
   </experiment>
   <experiment name="OM4p25_IAF_BLING_csf_rerun" inherit="OM4p25_IAF_BLING_CFC_csf">
    <publicMetadata DBswitch="$(MDBIswitch)">
      <!-- Realization tag -->
      <realization r="1" i="1" p="1" f="1"/>
      <!-- project info -->
      <project>CMIP6</project>
      <activity_id>OMIP</activity_id>
      <mip_era>CMIP6</mip_era>
      <!-- model info -->
  <source>GFDL-CM4 (2018): \naerosol: interactive\natmos: GFDL-AM4.0.1 (Cubed-sphere (c96) - 1 degree nominal horizontal resolution; 360 x 180 longitude/latitude; 33 levels; top level 1 hPa)\natmosChem: fast chemistry, aerosol only\nland: GFDL-LM4.0.1 (1 degree nominal horizontal resolution; 360 x 180 longitude/latitude; 20 levels; bot level 10m); land:Veg:unnamed (dynamic vegetation, dynamic land use); land:Hydro:unnamed (soil water and ice, multi-layer snow, rivers and lakes)\nlandIce: GFDL-LM4.0.1\nocean: GFDL-OM4p25 (GFDL-MOM6, tripolar - nominal 0.25 deg; 1440 x 1080 longitude/latitude; 75 levels; top grid cell 0-2 m)\nocnBgchem: GFDL-BLINGv2\nseaIce: GFDL-SIM4p25 (GFDL-SIS2.0, tripolar - nominal 0.25 deg; 1440 x 1080 longitude/latitude; 5 layers; 5 thickness categories) 
  </source>

      <source_id>GFDL-CM4</source_id>
      <source_type>OGCM</source_type>
      <!--experiment info-->
      <experiment_name>OMIP experiment forced by CORE Inter-Annual Forcing (CIAF) version 2.0 and initialized with observed physical and biogeochemical ocean data</experiment_name>
      <experiment_id>omip1</experiment_id>
      <sub_experiment>none</sub_experiment>
      <sub_experiment_id>none</sub_experiment_id>
      <start_time>$(EXP_CPLD_START)</start_time>
      <end_time>$(EXP_CPLD_END)</end_time>
      <!-- branch info -->
      <branch_method>standard</branch_method>
      <branch_time_in_child>0.0D0</branch_time_in_child>
      <branch_time_in_parent></branch_time_in_parent>
      <!-- variant info-->
      <variant_info></variant_info>
      <!--parent info-->
      <parent_time_units>days since 1708-1-1</parent_time_units>
      <parent_activity_id>CMIP</parent_activity_id>
      <parent_experiment_id></parent_experiment_id>
      <parent_mip_era>CMIP6</parent_mip_era>
      <parent_source_id>GFDL-CM4</parent_source_id>
      <parent_variant_label>r1i1p1f1</parent_variant_label>
      <comment>
       Experiment name = $(name)
    For more information please refer to the
    &lt;a href="https://github.com/NOAA-GFDL/MOM6-examples/wiki"&gt; MOM6 Wiki.  &lt;/a&gt;
      </comment>

    </publicMetadata>
     <!--MOM_overrides-->
     <input>
     <namelist name="generic_tracer_nml">
       do_generic_tracer=.true.
       do_generic_BLING=.true.
       do_generic_CFC=.false.
       do_generic_SF6=.false.
       do_generic_age=.false.
       do_generic_argon=.false.
       do_generic_COBALT=.false.
       force_update_fluxes=.true.
      </namelist>
       <diagTable order="append">
"ocean_Tropics_monthly",         1, "months",   1, "days", "time"
"ocean_model_z2", "volcello", "volcello", "ocean_Tropics_monthly", "all", "mean", "-255. 19. -5. 5. -1 -1",2
"ocean_model_z2", "thetao",   "thetao",   "ocean_Tropics_monthly", "all", "mean", "-255. 19. -5. 5. -1 -1",2
"ocean_model_z2", "so",       "so",       "ocean_Tropics_monthly", "all", "mean", "-255. 19. -5. 5. -1 -1",2
"ocean_model_z2", "umo",      "umo",      "ocean_Tropics_monthly", "all", "mean", "-255. 19. -5. 5. -1 -1",2
"ocean_model_z2", "uo",       "uo",       "ocean_Tropics_monthly", "all", "mean", "-255. 19. -5. 5. -1 -1",2
"ocean_model_z2", "vmo",      "vmo",      "ocean_Tropics_monthly", "all", "mean", "-255. 19. -5. 5. -1 -1",2
"ocean_model_z2", "vo",       "vo",       "ocean_Tropics_monthly", "all", "mean", "-255. 19. -5. 5. -1 -1",2
"ocean_model_rho2","vo",   "vo",     "ocean_annual_rho2",  "all", "mean", "none",2
"ocean_model_rho2","vo",   "vo",     "ocean_month_rho2",   "all", "mean", "none",2
       </diagTable>
       <csh>
         <![CDATA[
# Get new diagnostic coordinate file
cp /lustre/f2/pdata/gfdl/cmip6/datasets/OMIP/diagnostic/diag_rho2.nc $work/INPUT/
cat > $work/INPUT/MOM_override << MOM_OVERRIDE_EOF
# Turn on generic tracers
USE_generic_tracer = True
# Fix sign error in adjustment of net fresh-water
USE_NET_FW_ADJUSTMENT_SIGN_BUG = False
# Add a uniform 10m diagnostic coordinate between 0 and 350m
#override NUM_DIAG_COORDS = 3
#override DIAG_COORDS = "z Z ZSTAR", "rho2 RHO2 RHO", "z2 Z2 ZSTAR"
DIAG_COORD_DEF_Z2 = "UNIFORM:35,350"
# Use finer resolution rho2 diagnostic coordinate
#override DIAG_COORD_DEF_RHO2 = "FILE:diag_rho2.nc,interfaces=rho2"
MOM_OVERRIDE_EOF
         ]]></csh>
     </input>

   </experiment>
   <experiment name="OM4p25_IAF_BLING_CFC_csf" inherit="MOM6_SIS2_compile$(MODIFIER)">
    <description>
global 1/4 degree z ocean_ice experiment 
regridded runoff and salinity
CORE2 dynamic inter_annual forcing data
    </description>  
    <publicMetadata DBswitch="$(MDBIswitch)">
      <!-- Realization tag -->
      <realization r="1" i="1" p="1" f="1"/>
      <!-- project info -->
      <project>CMIP6</project>
      <activity_id>OMIP</activity_id>
      <mip_era>CMIP6</mip_era>
      <!-- model info -->
      <!-- the model names are subject to change after arriving at a new name and registering it in CV-->	
      <source>GFDL-OM4_p25deg_CORE2 (2017)</source>
      <source_id>GFDL-OM4_p25deg_CORE2</source_id>
      <source_type>OGCM</source_type>
      <!--experiment info-->
      <experiment_name>OMIP experiment forced by CORE Inter-Annual Forcing (CIAF) version 2.0 and initialized with observed physical and biogeochemical ocean data</experiment_name>
      <experiment_id>omip2</experiment_id>
      <sub_experiment>none</sub_experiment>
      <sub_experiment_id>none</sub_experiment_id>
      <start_time>$(EXP_CPLD_START)</start_time>
      <end_time>$(EXP_CPLD_END)</end_time>
      <!-- branch info -->
      <branch_method>standard</branch_method>
      <branch_time_in_child>0.0D0</branch_time_in_child>
      <branch_time_in_parent></branch_time_in_parent>
      <!-- variant info-->
      <variant_info></variant_info>
      <!--parent info-->
      <parent_time_units>days since 1708-1-1</parent_time_units>
      <parent_activity_id>CMIP</parent_activity_id>
      <parent_experiment_id></parent_experiment_id>
      <parent_mip_era>CMIP6</parent_mip_era>
      <parent_source_id>GFDL-OM4</parent_source_id>
      <parent_variant_label>r1i1p1f1</parent_variant_label>
      <comment>
       Experiment name = $(name)
    For more information please refer to the
    &lt;a href="https://github.com/NOAA-GFDL/MOM6-examples/wiki"&gt; MOM6 Wiki.  &lt;/a&gt;
      </comment>

    </publicMetadata>
    <input>
      <namelist name="coupler_nml">
       months = $months,
       days   = $days,
       current_date = 1708,1,1,0,0,0,
       hours = 0
       minutes = 0
       seconds = 0
       calendar = 'NOLEAP',
       dt_cpld  = 3600,
       dt_atmos = 3600,
       do_atmos = .false.,
       do_land = .false.,
       do_ice = .true.,
       do_ocean = .true.,
       atmos_npes = 0,
       ocean_npes = 0,
       concurrent = .false.
       use_lag_fluxes=.false. 
       atmos_nthreads = $atm_threads
       ocean_nthreads = $ocn_threads
     </namelist>
     <namelist name="generic_tracer_nml">
       do_generic_tracer=.true.
       do_generic_BLING=.true.
       do_generic_CFC=.true.
       do_generic_SF6=.true.
       do_generic_age=.false.
       do_generic_argon=.false.
       do_generic_COBALT=.false.
       force_update_fluxes=.true.
      </namelist>
      <namelist name="generic_bling_nml">
       do_14c=.false.
       do_carbon=.true.
       do_carbon_pre=.false.
       do_po4_pre=.false.
       bury_caco3=.true.
       bury_pop=.true.
       co2_calc='mocsy'
      </namelist>
     <namelist name="diag_manager_nml">
       max_files = 400
       flush_nc_files=.false.
       max_axes = 400,
       max_num_axis_sets = 400,
       max_input_fields = 1200
       max_output_fields = 1800
       mix_snapshot_average_fields=.false.
     </namelist>
     <namelist name="xgrid_nml">
       make_exchange_reproduce = .true.
       interp_method = 'second_order'
     </namelist>
     <namelist name="fms_nml">
       clock_grain='ROUTINE'
       clock_flags='NONE'
       domains_stack_size = 8000000
       stack_size =0
     </namelist>
     <namelist name="fms_io_nml" >
       fms_netcdf_restart=.true.
       threading_read='multi'
       max_files_r = 800
       max_files_w = 800
     </namelist>
     <namelist name="atmos_model_nml" >
       layout= 0, 0
     </namelist>
     <!--verona-->
     <namelist name="sat_vapor_pres_nml">
      construct_table_wrt_liq = .true.,
      construct_table_wrt_liq_and_ice = .true.,
     </namelist>

     <dataFile label="namelist" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/input.nml</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/input.nml</dataSource>
     </dataFile>
      
      <!--common setup-->
      <xi:include xpointer="xpointer(//freInclude[@name='OM4_common']/input/node())"/>
      <!--OM4 gridSpec mosaic datasets-->
      <xi:include xpointer="xpointer(//freInclude[@name='OM4p25_grid']/input/node())"/>
      <!--MOM6 Input datasets-->
      <xi:include xpointer="xpointer(//freInclude[@name='OM4p25_data']/input/node())"/>
      <!--SIS2 Input datasets-->
      <xi:include xpointer="xpointer(//freInclude[@name='SIS2_data']/input/node())"/>

     <!--diag_tables-->

     <diagTable>
$name
$baseDate
     </diagTable>
     <xi:include xpointer="xpointer(//freInclude[@name='diag_table_GENERICS']/input/node())"/>
      <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(AWG_INPUT_HOME)/diag_table/diag_table_BLING</dataSource>
      </dataFile>

     <!--data_tables and data files-->
     <!--CORE2 forcing-->
     <xi:include xpointer="xpointer(//freInclude[@name='CORE2_IAF_data']/input/node())"/>
      <dataFile label="dataTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/data_table_iaf</dataSource>
      </dataFile>

      <xi:include xpointer="xpointer(//freInclude[@name='BLING_data_table']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='CFC_data_table']/input/node())"/>

     <!--field_tables-->

     <dataFile label="fieldTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/field_table</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/field_table</dataSource>
     </dataFile>

      <!--BLING specific datasets and tables-->
      <!--COBALT IC datasets used in BLING field_table-->
      <xi:include xpointer="xpointer(//freInclude[@name='OBGC_data_set']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='BLING_field_table']/input/node())"/>
      <fieldTable order="append">
###.................................................
### INERT TRACERS field table   (2018/07/06)
### jgj 2018/07/06 - need sf6 and cfc field table entries due to 2 changes in generic_tracer_utils.F90
###                  these code changes set require_src_info and requires_restart to true for each tracer
##
"namelists","ocean_mod","generic_sf6"
sf6_requires_src_info = f
sf6_requires_restart = f
/
"namelists","ocean_mod","generic_cfc"
cfc11_requires_src_info = f
cfc11_requires_restart = f

cfc12_requires_src_info = f
cfc12_requires_restart = f
/
     </fieldTable>

     <!--MOM_overrides-->
     <csh>
        <![CDATA[
cat > $work/INPUT/MOM_override << MOM_OVERRIDE_EOF
# Turn on generic tracers
USE_generic_tracer = True
#override USE_NET_FW_ADJUSTMENT_SIGN_BUG = False
MOM_OVERRIDE_EOF

#To let the model start ocean/ocean bgc tracers when some are missing from the initCond file
#in order to cold start sf6 and cfcs which are not in the initCond
#the override TRACERS_MAY_REINIT = True  makes the presence of tracers in restart file not mandatory
#they are still read if they are present
if ( $currentSeg == 1 ) then
cat >> $work/INPUT/MOM_override << MOM_OVERRIDE_2
#override TRACERS_MAY_REINIT = True !This makes the presence of tracers in restart file not mandatory
MOM_OVERRIDE_2
endif
     ]]></csh>

   </input>

    <runtime>   
      <production simTime="$(PROD_SIMTIME)" units="years">
          <segment simTime="12" units="months"/>
          <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_O4671_production']/node())"/>
      </production>
      <regression name="basic">
        <run months="1" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1756']/node())"/> </run>
      </regression>
      <regression name="rts">
        <run days="15 16" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1756']/node())"/> </run>
         <!--the following should reproduce eachother but not the basic because basic uses mask_table-->
         <run days="2" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O864x2']/node())"/> </run>
         <run days="2" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1440']/node())"/> </run>
         <run days="2" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1296']/node())"/> </run>
      </regression>
      <regression name="basic_d2">
        <run months="1" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1440']/node())"/> </run>
      </regression>
      <regression name="debug">
        <run days="2" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O864']/node())"/> </run>
      </regression>
      <reference restart="$(REFERENCE)/archive/1x1m0d_1756x1o/restart/17080201.tar"/>
    </runtime>

    <postProcess>
      <xi:include xpointer="xpointer(//freInclude[@name='OM4_postprocess']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='ocean_regions']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='BLING_postprocess']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='inert_postprocess']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='inert_z_postprocess']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='inert_postprocess_1x1deg']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='inert_z_postprocess_1x1deg']/postProcess/node())"/>    </postProcess>
   </experiment>
   <freInclude name="OM4p25_grid">
    <input>
      <dataFile label="gridSpec" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/grid_spec.nc</dataSource>
        <dataSource site="theia">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/grid_spec.nc</dataSource>
        <dataSource site="gfdl">/archive/gold/datasets/OM4_025/mosaic.v20170622.tar</dataSource> 
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/atmos_mosaic_tile1Xland_mosaic_tile1.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/atmos_mosaic_tile1Xocean_mosaic_tile1.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/land_mask.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/land_mosaic_tile1Xocean_mosaic_tile1.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/ocean_hgrid.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/ocean_mask.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/ocean_mosaic.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/ocean_topog.nc</dataSource>
       <!--hsmget cannot get this  <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/topog.nc</dataSource> -->
      </dataFile>
    </input>
   </freInclude>
   
   <freInclude name="OM4p25_data">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/runoff.daitren.clim.1440x1080.v20180328.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/runoff.daitren.iaf.1440x1080.v20180328.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/seawifs-clim-1997-2010.1440x1080.v20180328.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/salt_restore_PHC2.1440x1080.v20180405.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/MOM_input</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/layer_coord.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/MOM_saltrestore</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/tidal_amplitude.v20140616.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/MOM_channels_global_025</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/vgrid_75_2m.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/vgrid_75_2m_575m.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/hycom1_75.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/hycom1_75_800m.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/analysis_vgrid_lev35.v1.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/Faroe_edits.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/Faroe_GS_edits.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/All_edits.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/woa13_decav_ptemp_monthly_fulldepth_01.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/woa13_decav_s_monthly_fulldepth_01.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       $(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/mask_table.33.16x18     
       $(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/mask_table.96.32x18     
       $(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/mask_table.242.32x36     
       $(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/mask_table.274.36x36     
       $(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/mask_table.315.32x45    
       $(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/mask_table.548.32x72
       $(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/mask_table.622.36x72
       $(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/mask_table.808.45x72
       $(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/mask_table.1053.90x45
       $(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/mask_table.1809.90x72
       $(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/mask_table.1309.90x54     
       $(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/mask_table.1402.72x72
       $(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/mask_table.3785.90x144
      </dataFile>
      <dataFile label="input" target="INPUT/ocean_static_no_mask_table.nc" chksum="" size="" timestamp="">
          <dataSource site="ncrc">$(gfdlO_pdata)/datasets/OM4_025/mosaic.v20140610.unpacked/ocean_static.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/geothermal_davies2013_v1.nc</dataSource>
      </dataFile>
      <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.MOM6</dataSource>
        <dataSource site="theia">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.MOM6</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/diag_table.MOM6</dataSource>
      </dataFile>
<!-- "heat_content_vprec" are repeated in diag_table.MOM6
      <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.OM4</dataSource>
        <dataSource site="theia">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.OM4</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/diag_table.OM4</dataSource>
      </dataFile>
-->
      <diagTable order="append">
# MOM6 ocean diagnostics only used in a CORE/OMIP (no interactive atmos). 
# These terms provide diagnostics for the surface salinity / fresh water restoring. 
 "ocean_model", "vprec",              "vprec",              "ocean_annual", "all", "mean", "none",2
 "ocean_model", "salt_flux_added",    "salt_flux_added",    "ocean_annual", "all", "mean", "none",2

 "ocean_model", "vprec",              "vprec",              "ocean_month", "all", "mean", "none",2
 "ocean_model", "salt_flux_added",    "salt_flux_added",    "ocean_month", "all", "mean", "none",2
      </diagTable>

      <namelist name="MOM_input_nml" >
         output_directory = './',
         input_filename = '$restart_flag'
         restart_input_dir = 'INPUT/',
         restart_output_dir = 'RESTART/',
         parameter_filename = 'INPUT/MOM_input','INPUT/MOM_layout','INPUT/MOM_saltrestore','INPUT/MOM_override'
     </namelist>

     </input>

   </freInclude>

   <freInclude name="SIS2_data">
    <input>

     <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.SIS</dataSource>
        <dataSource site="theia">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.SIS</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/diag_table.SIS</dataSource>
     </dataFile>

     <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/SIS_input</dataSource>
     </dataFile>

     <namelist name="SIS_input_nml" >
         output_directory = './',
         input_filename = '$restart_flag'
         restart_input_dir = 'INPUT/',
         restart_output_dir = 'RESTART/',
         parameter_filename = 'INPUT/SIS_input','INPUT/SIS_layout','INPUT/SIS_diurnal','INPUT/SIS_override'
     </namelist>

     </input>
   </freInclude>

   <experiment name="OM4p25_zstar" inherit="OM4p25_IAF_BLING_CFC_csf">
    <input>
     <csh>
        <![CDATA[
cat > $work/INPUT/MOM_override << MOM_OVERRIDE_EOF
# Turn on generic tracers
USE_generic_tracer = True
#override USE_NET_FW_ADJUSTMENT_SIGN_BUG = False
#override REGRIDDING_COORDINATE_MODE = "Z*"
#override ALE_COORDINATE_CONFIG = "FNC1:2,6500,6,.01"
MOM_OVERRIDE_EOF
     ]]></csh>
    </input>
   </experiment>
   
   <experiment name="OM4p25_IAF_BLING_CFC_csf_diagd2$(MODIFIER)" inherit="OM4p25_IAF_BLING_CFC_csf">
    <input>
     <diagTable>
$name
$baseDate
     </diagTable>
      <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.MOM6.d2</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/diag_table.MOM6.d2</dataSource>
      </dataFile>
     <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.SIS</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/diag_table.SIS</dataSource>
     </dataFile>
    </input>
   </experiment>

   <!--****************************************************************************************-->
   <!--***************************** 1/2 degree experiments        ****************************-->
   <!--****************************************************************************************-->
											      
   <experiment name="OM4p5_IAF_BLING_CFC_abio_csf_mle200_initCond1998" inherit="OM4p5_IAF_BLING_CFC_abio_csf_mle200">
    <input>								      
     <!--There is  MOM6/SIS2 restart provided in initCond.-->
     <namelist name="MOM_input_nml" >
         output_directory = './',
         input_filename = 'r'
         restart_input_dir = 'INPUT/',
         restart_output_dir = 'RESTART/',
         parameter_filename = 'INPUT/MOM_input','INPUT/MOM_layout','INPUT/MOM_override','INPUT/MOM_saltrestore'
     </namelist>
     <namelist name="SIS_input_nml" >
         output_directory = './',
         input_filename = 'r'
         restart_input_dir = 'INPUT/',
         restart_output_dir = 'RESTART/',
         parameter_filename = 'INPUT/SIS_input','INPUT/SIS_layout','INPUT/SIS_override','INPUT/SIS_diurnal'
     </namelist>
<!--
      <dataFile label="initCond" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">/lustre/f2/dev/John.Krasting/cwg/IC/OM4p5_IAF_BLING_CFC_abio_csf_mle200.20080101.tar</dataSource>
      </dataFile>

      <dataFile label="initCond" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">/lustre/f2/dev/Niki.Zadeh/archive/input/xanadu/OM4p5_IAF_BLING_CFC_abio_csf_mle200.20080101_combined.tar</dataSource>
      </dataFile>
      <dataFile label="initCond" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">/lustre/f2/dev/gfdl/John.Krasting/cwg/IC/OM4p5_IAF_BLING_CFC_abio_csf_mle200.19980101.combined.tar</dataSource>
      </dataFile>
-->
      <dataFile label="initCond" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">/lustre/f2/dev/John.Krasting/cwg/IC/OM4p5_IAF_BLING_CFC_abio_csf_mle200.19980101.tar</dataSource>
      </dataFile>
     <!--MOM_overrides-->
     <csh>
       <![CDATA[
cat > $work/INPUT/MOM_override << MOM_OVERRIDE_EOF
# Turn on generic tracers
USE_generic_tracer = True
GENERIC_TRACER_IC_FILE = "MOM_GENERICS.res.nc"
#override DIAG_COORD_DEF_RHO2 = "FILE:diag_rho2.nc,interfaces=rho2"
#override DEBUG  = True

MOM_OVERRIDE_EOF

cat > $work/INPUT/SIS_override << SIS_OVERRIDE_EOF
#override NIGLOBAL = 720
#override NJGLOBAL = 576
#override U_TRUNC_FILE = "SIS_U_truncations"
#override V_TRUNC_FILE = "SIS_V_truncations"
#override MIN_OCN_INTERTIAL_H = 2.

#override ADD_DIURNAL_SW = True 
#override ICE_STATS_INTERVAL = 30

#override DEBUG  = True
SIS_OVERRIDE_EOF

####################################################################################################
##The following is to avoid model crash with a layout other than the one that produced the initCond.
##The problem could occur if the generating model run used a mask_table that was different from the
##current model run. Specifically, when SIS2 reads the ice_model.res.nc it chokes on the unphysical 
##values on land on the masked pes (9.96E36) that should have been set as "missing values". 
##I am pretty sure that there is a bug in SIS2 that tickles this, but I do not have a smoking gun.
##
if ( $currentSeg == 10 ) then
  cd $work/INPUT
  cp ice_model.res.nc ice_model.res1.nc

  #All ice restart variables should be 0 where they have a "missing value" (9.96E36)
  foreach var ( T_skin coszen rough_moist rough_heat rough_mom sym_str_s str_t str_d sym_v_ice_C sym_u_ice_C sal_ice enth_ice H_to_kg_m2 h_ice enth_snow h_snow h_pond flux_sw_nir_dif flux_sw_nir_dir flux_sw_vis_dif flux_sw_vis_dir p_surf calving_hflx runoff_hflx calving runoff fprec lprec flux_lw flux_salt flux_q flux_t flux_v flux_u )
     ncap2 -s "where( $var > 1e36) $var =0.0" ice_model.res1.nc ice_model.res2.nc
     mv -f ice_model.res2.nc ice_model.res1.nc
  end

  #except part_size that should be 1 for category 1 and 0 otherwise. But I don't know how to do that!
  #The next best guess would be 1/6 for all categories so that they add up to 1:
  ncap2 -s 'where( (part_size>1e36) ) part_size =1.0/6.0' ice_model.res1.nc ice_model.res2.nc

  cp -f ice_model.res2.nc  ice_model.res.nc

  #Same story with calving.res.nc
  cp -f calving.res.nc calving.res1.nc
  ncap2 -s 'where( stored_ice>1e36 ) stored_ice =0.0' calving.res1.nc calving.res2.nc
  mv -f calving.res2.nc calving.res1.nc
  ncap2 -s 'where( stored_heat>1e36 ) stored_heat =0.0' calving.res1.nc calving.res2.nc
  mv -f calving.res2.nc calving.res.nc

  cd $work
endif
     ]]></csh>
    </input>
   </experiment>

   <experiment name="OM4p5_IAF_BLING_CFC_abio_csf_mle200" inherit="MOM6_SIS2_compile$(MODIFIER)">
   <publicMetadata DBswitch="$(MDBIswitch)">
      <!-- Realization tag -->
      <realization r="1" i="1" p="1" f="1"/>
      <!-- project info -->
      <project>"$(ProjectID)"</project>
      <activity_id>OMIP</activity_id>
      <mip_era>CMIP6</mip_era>
      <!-- model info --> 
      <!-- the model names are subject to change after arriving at a new name and registering it in CV-->	
  <source>GFDL-OM4p5B (2018): \naerosol: none\natmos: none\natmosChem: none\nland: none\nlandIce: none\nocean: GFDL-OM4p5 (GFDL-MOM6, tripolar - nominal 0.5 deg; 720 x 576 longitude/latitude; 75 levels; top grid cell 0-2 m)\nocnBgchem: GFDL-BLINGv2\nseaIce: GFDL-SIM4p5 (GFDL-SIS2.0, tripolar - nominal 0.5 deg; 720 x 576 longitude/latitude; 5 layers; 5 thickness categories) 
  </source>
      <source_id>GFDL-OM4p5B</source_id>
      <source_type>OGCM</source_type>
      <!--experiment info-->
      <experiment_name>OMIP experiment forced by CORE Inter-Annual Forcing (CIAF) version 2.0 and initialized with observed physical and biogeochemical ocean data</experiment_name>
      <experiment_id>omip1</experiment_id>
      <sub_experiment>none</sub_experiment>
      <sub_experiment_id>none</sub_experiment_id>
      <start_time>$(EXP_CPLD_START)</start_time>
      <end_time>$(EXP_CPLD_END)</end_time>
      <!-- branch info -->
      <branch_method>standard</branch_method>
      <branch_time_in_child>0.0D0</branch_time_in_child>
      <branch_time_in_parent>0.0D0</branch_time_in_parent>
      <!-- variant info-->
      <variant_info></variant_info>
      <!--parent info-->
      <parent_time_units>days since 1708-1-1</parent_time_units>
      <parent_activity_id>no parent</parent_activity_id>
      <parent_experiment_id></parent_experiment_id>
      <parent_mip_era>CMIP6</parent_mip_era>
      <parent_source_id>no parent</parent_source_id>
      <parent_variant_label>no parent</parent_variant_label>
      <comment>
       Experiment name = $(name)
    For more information please refer to the
    &lt;a href="https://github.com/NOAA-GFDL/MOM6-examples/wiki"&gt; MOM6 Wiki.  &lt;/a&gt;
      </comment>

    </publicMetadata>

    <input> 
      <namelist name="coupler_nml">
       months = $months,
       days   = $days,
       current_date = 1708,1,1,0,0,0,
       hours = 0
       minutes = 0
       seconds = 0
       calendar = 'NOLEAP',
       dt_cpld  = 3600, 
       dt_atmos = 3600, 
       do_atmos = .false.,
       do_land = .false.,
       do_ice = .true.,
       do_ocean = .true.,
       atmos_npes = 0,
       ocean_npes = 0,
       concurrent = .false.
       use_lag_fluxes=.false.
       atmos_nthreads = $atm_threads
       ocean_nthreads = $ocn_threads
     </namelist>
     <namelist name="generic_tracer_nml">
       do_generic_tracer=.true.
       do_generic_abiotic=.true.
       do_generic_BLING=.true.
       do_generic_CFC=.true.
       do_generic_SF6=.true.
       do_generic_age=.false.
       do_generic_argon=.false.
       do_generic_COBALT=.false.
       force_update_fluxes=.true.
      </namelist>
      <namelist name="generic_abiotic_nml">
       co2_calc='mocsy'
      </namelist>
      <namelist name="generic_bling_nml">
       do_14c=.false.
       do_carbon=.true.
       do_carbon_pre=.false.
       do_po4_pre=.false.
       bury_caco3=.true.
       bury_pop=.true.
       co2_calc='mocsy'
      </namelist>
     <namelist name="diag_manager_nml">
       max_files = 400
       flush_nc_files=.false.
       max_axes = 400,
       max_num_axis_sets = 400,
       max_input_fields = 1200
       max_output_fields = 1800
       mix_snapshot_average_fields=.false.
     </namelist>
     <namelist name="xgrid_nml">
       make_exchange_reproduce = .true.
       interp_method = 'second_order'
     </namelist>
     <namelist name="fms_nml">
       clock_grain='ROUTINE'
       clock_flags='NONE'
       domains_stack_size = 8000000
       stack_size =0
     </namelist>
     <namelist name="fms_io_nml" >
       fms_netcdf_restart=.true.
       threading_read='multi'
       max_files_r = 800
       max_files_w = 800
     </namelist>
     <namelist name="atmos_model_nml" >
       layout= 0, 0
     </namelist>
     <!--verona-->
     <namelist name="sat_vapor_pres_nml">
      construct_table_wrt_liq = .true.,
      construct_table_wrt_liq_and_ice = .true.,
     </namelist>

     <dataFile label="namelist" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/input.nml</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_05/input.nml</dataSource>
     </dataFile>

      <!--common setup-->
      <xi:include xpointer="xpointer(//freInclude[@name='OM4_common']/input/node())"/>
      <!--OM4 gridSpec mosaic datasets-->
      <xi:include xpointer="xpointer(//freInclude[@name='OM4p5grid_data']/input/node())"/>
      <!--MOM6 Input datasets-->
      <xi:include xpointer="xpointer(//freInclude[@name='OM4p5_data']/input/node())"/>
      <!--SIS2 Input datasets-->
      <xi:include xpointer="xpointer(//freInclude[@name='SIS2_data']/input/node())"/>

     <!--diag_tables-->

     <diagTable>
$name
$baseDate
     </diagTable>
     <xi:include xpointer="xpointer(//freInclude[@name='diag_table_GENERICS']/input/node())"/>
     <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(AWG_INPUT_HOME)/diag_table/diag_table_BLING</dataSource>
     </dataFile>

      <diagTable order="append">
"ocean_model_rho2","vo",   "vo",     "ocean_annual_rho2",  "all", "mean", "none",2
"ocean_model_rho2","vo",   "vo",     "ocean_month_rho2",   "all", "mean", "none",2
"ocean_model_z", "opottemppmdiff", "opottemppmdiff", "ocean_annual_z", "all", "mean", "none",2
      </diagTable>

      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">/lustre/f2/pdata/gfdl/cmip6/datasets/OMIP/diagnostic/diag_rho2.nc</dataSource>
      </dataFile>

     <!--data_tables and data files-->
     <!--CORE2 forcing-->
     <xi:include xpointer="xpointer(//freInclude[@name='CORE2_IAF_data']/input/node())"/>
     <dataFile label="dataTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/data_table_iaf</dataSource>
     </dataFile>

      <xi:include xpointer="xpointer(//freInclude[@name='BLING_data_table']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='CFC_data_table']/input/node())"/>

      <xi:include xpointer="xpointer(//freInclude[@name='ABIO_data_table']/input/node())"/>

     <!--field_tables-->

     <dataFile label="fieldTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/field_table</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_05/field_table</dataSource>
     </dataFile>

      <fieldTable order="append">
###.................................................
### INERT TRACERS field table   (2018/07/06)
### jgj 2018/07/06 - need sf6 and cfc field table entries due to 2 changes in generic_tracer_utils.F90
###                  these code changes set require_src_info and requires_restart to true for each tracer
##
"namelists","ocean_mod","generic_sf6"
sf6_requires_src_info = f
sf6_requires_restart = f
/
"namelists","ocean_mod","generic_cfc"
cfc11_requires_src_info = f
cfc11_requires_restart = f

cfc12_requires_src_info = f
cfc12_requires_restart = f
/
     </fieldTable>

      <!--BLING specific datasets and tables-->
      <!--COBALT IC datasets used in BLING field_table-->
      <xi:include xpointer="xpointer(//freInclude[@name='OBGC_data_set']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='BLING_field_table']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='ABIO_field_table']/input/node())"/>


      <dataFile label="input" target="INPUT/MOM_GENERICS.res.nc" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(KRASTING)/cwg/input/cfc/MOM_GENERICS_OM4p5.20170829.res.nc</dataSource>
      </dataFile>

     <!--MOM_overrides-->
     <csh>
       <![CDATA[
cat > $work/INPUT/MOM_override << MOM_OVERRIDE_EOF
# Turn on generic tracers
USE_generic_tracer = True
GENERIC_TRACER_IC_FILE = "MOM_GENERICS.res.nc"
#override DIAG_COORD_DEF_RHO2 = "FILE:diag_rho2.nc,interfaces=rho2"

MOM_OVERRIDE_EOF

cat > $work/INPUT/SIS_override << SIS_OVERRIDE_EOF
#override NIGLOBAL = 720
#override NJGLOBAL = 576
#override U_TRUNC_FILE = "SIS_U_truncations"
#override V_TRUNC_FILE = "SIS_V_truncations"
#override MIN_OCN_INTERTIAL_H = 2.

#override ADD_DIURNAL_SW = True 
#override ICE_STATS_INTERVAL = 30
SIS_OVERRIDE_EOF

     ]]></csh>

    </input> 

   <runtime>
      <production simTime="$(PROD_SIMTIME)" units="years">
          <segment simTime="12" units="months"/>
          <xi:include xpointer="xpointer(//freInclude[@name='resourceparams_O1057p5_production']/node())"/>
      </production>

      <regression name="basic_prod_nomask">
        <run months="1" >   <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1620']/node())"/> </run>
        <run days="15 16" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1620']/node())"/> </run>
      </regression>
      <regression name="basic_prod">
        <run months="1" >   <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1300p5']/node())"/> </run>
        <run days="15 16" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1300p5']/node())"/> </run>
      </regression>
      <regression name="debug_prod">
        <run days="1" >   <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1300p5']/node())"/> </run>
      </regression>
      <regression name="basic">
        <run months="1" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1057p5']/node())"/> </run>
      </regression>
      <regression name="rts">
        <run days="15 16" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1057p5']/node())"/> </run>
        <!--the following should reproduce eachother but not the basic because basic uses mask_table-->
        <run days="2" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1296']/node())"/> </run>
        <run days="2" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O648']/node())"/> </run>
        <run days="2" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O256']/node())"/> </run>
      </regression>
      <regression name="debug">
        <run days="2" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O256']/node())"/> </run>
        <run days="1 1" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O256']/node())"/> </run>
      </regression>

      <regression name="rts2">
          <run days="8"  ><xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1728']/node())"/> </run>
          <run days="4 4"><xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O1728']/node())"/> </run>
      </regression>
 
      <regression name="restart">
        <run months="1"   > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O2783p5']/node())"/> </run>
        <run days="15 16" > <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O2783p5']/node())"/> </run>
      </regression>
      <regression name="debug2">
        <run days="1 1" overrideParams="coupler_nml:current_date=1958,12,31,0,0,0"> <xi:include href="awg_include/xml_building_blocks/layouts.xml" xpointer="xpointer(//freInclude[@name='resourceparams_O256']/node())"/> </run>
      </regression>
      <reference restart="$(REFERENCE)/archive/1x1m0d_1057x1o/restart/17080201.tar"/>
   </runtime>


    <postProcess>
      <xi:include xpointer="xpointer(//freInclude[@name='OM4_postprocess']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='ocean_regions']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='BLING_postprocess']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='abiotic_postprocess']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='abiotic_z_postprocess']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='inert_postprocess']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='inert_z_postprocess']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='abiotic_postprocess_1x1deg']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='abiotic_z_postprocess_1x1deg']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='inert_postprocess_1x1deg']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='inert_z_postprocess_1x1deg']/postProcess/node())"/>
    </postProcess>
   </experiment>

   <experiment name="OM4p5_IAF_BLING_CFC_abio_csf_p25config" inherit="OM4p5_IAF_BLING_CFC_abio_csf_mle200">
     <input>
     <!--MOM_overrides-->
     <csh>
        <![CDATA[
cat > $work/INPUT/MOM_override << MOM_OVERRIDE_EOF
# Turn on generic tracers
USE_generic_tracer = True
GENERIC_TRACER_IC_FILE = "MOM_GENERICS.res.nc"
#override MLE_FRONT_LENGTH = 500.0
#override KHTH_USE_EBT_STRUCT = False 
#override KHTH_USE_FGNV_STREAMFUNCTION = False
#override KHTR = 0.0
#override KH_RES_FN_POWER = 2
#override KH_SIN_LAT = 0.0
#override KH_VEL_SCALE = 0.0
#override MEKE_KHTH_FAC = 0.0
#override MEKE_KHTR_FAC = 0.0
#override MEKE_VISCOSITY_COEFF = 0.0
#override SMAGORINSKY_KH = False
#override USE_NEUTRAL_DIFFUSION = False
#override VISC_RES_FN_POWER = 2
#override MAX_TR_DIFFUSION_CFL = -1.0
MOM_OVERRIDE_EOF

cat > $work/INPUT/SIS_override << SIS_OVERRIDE_EOF
#override NIGLOBAL = 720
#override NJGLOBAL = 576
#override U_TRUNC_FILE = "SIS_U_truncations"
#override V_TRUNC_FILE = "SIS_V_truncations"
#override MIN_OCN_INTERTIAL_H = 2.

#override ADD_DIURNAL_SW = True 
#override ICE_STATS_INTERVAL = 30
SIS_OVERRIDE_EOF

     ]]></csh>

     </input>
   </experiment>

   <experiment name="OM4p5_IAF_BLING_CFC_abio_csf_p25config_diagd2$(MODIFIER)" inherit="OM4p5_IAF_BLING_CFC_abio_csf_p25config">
    <input>
     <diagTable>
$name
$baseDate
     </diagTable>
      <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.MOM6.d2</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/diag_table.MOM6.d2</dataSource>
      </dataFile>
     <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.SIS</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/diag_table.SIS</dataSource>
     </dataFile>
    </input>
   </experiment>
   <freInclude name="OM4p5grid_data">
    <input>
      <dataFile label="gridSpec" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(gfdlO_pdata)/datasets/OM4_05/mosaic_ocean.v20180227.tar</dataSource>
        <dataSource site="gfdl">/archive/gold/datasets/OM4_05/mosaic_ocean.v20180227.tar</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(ARCHIVE_NNZ)/input/xanadu/OMp5_mask_tables.tar</dataSource>
      </dataFile>
    </input>
   </freInclude>

   <freInclude name="OM4p5_data">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/INPUT/runoff.daitren.iaf.720x576.v20180328.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/INPUT/runoff.daitren.clim.720x576.v20180328.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/INPUT/seawifs-clim-1997-2010.720x576.v20180328.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/INPUT/salt_restore_PHC2.720x576.v20180405.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/INPUT/tidal_amplitude.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/INPUT/geothermal_davies2013_v1.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/INPUT/woa13_decav_ptemp_monthly_fulldepth_01.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/INPUT/woa13_decav_s_monthly_fulldepth_01.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/ocean_static_no_mask_table.nc" chksum="" size="" timestamp="">
       <dataSource site="ncrc">$(gfdlO_pdata)/datasets/OM4_05/mosaic_ocean.v20180227.unpacked/ocean_static.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/INPUT/layer_coord.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/INPUT/MOM_channels_global_025</dataSource>
      </dataFile>      
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/MOM_input</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_05/MOM_saltrestore</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/analysis_vgrid_lev35.v1.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
       <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/INPUT/hycom1_75_800m.nc</dataSource>
      </dataFile>

      <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.MOM6</dataSource>
        <dataSource site="theia">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.MOM6</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/diag_table.MOM6</dataSource>
      </dataFile>
<!-- "heat_content_vprec" are repeated in diag_table.MOM6 
      When this is fixed in mom6_examples we can replace the following "append" block by this dataFile
      <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.OM4</dataSource>
        <dataSource site="theia">$(MOM6_EXAMPLES)/ice_ocean_SIS2/OM4_025/diag_table.OM4</dataSource>
        <dataSource site="gfdl">$(NB_ROOT)/mom6/ice_ocean_SIS2/OM4_025/diag_table.OM4</dataSource>
      </dataFile>
-->
      <diagTable order="append">
# MOM6 ocean diagnostics only used in a CORE/OMIP (no interactive atmos). 
# These terms provide diagnostics for the surface salinity / fresh water restoring. 
 "ocean_model", "vprec",              "vprec",              "ocean_annual", "all", "mean", "none",2
 "ocean_model", "salt_flux_added",    "salt_flux_added",    "ocean_annual", "all", "mean", "none",2

 "ocean_model", "vprec",              "vprec",              "ocean_month", "all", "mean", "none",2
 "ocean_model", "salt_flux_added",    "salt_flux_added",    "ocean_month", "all", "mean", "none",2
      </diagTable>
     <namelist name="MOM_input_nml" >
         output_directory = './',
         input_filename = '$restart_flag'
         restart_input_dir = 'INPUT/',
         restart_output_dir = 'RESTART/',
         parameter_filename = 'INPUT/MOM_input','INPUT/MOM_layout','INPUT/MOM_saltrestore','INPUT/MOM_override'
     </namelist>

     </input>
   </freInclude>

  <freInclude name="OBGC_data_set">
    <input>
       <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/ESM4/OBGC/woa13/woa13_all_n_annual_01.nc</dataSource>
       </dataFile>
       <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/ESM4/OBGC/woa13/woa13_all_p_annual_01.nc</dataSource>
       </dataFile>
       <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/ESM4/OBGC/woa13/woa13_all_i_annual_01.nc</dataSource>
       </dataFile>
       <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/ESM4/OBGC/woa13/woa13_all_o_annual_01.nc</dataSource>
       </dataFile>
       <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/ESM4/OBGC/glodap/20160927/Alk.nc</dataSource>
       </dataFile>
       <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/ESM4/OBGC/glodap/20160927/Preind_DIC.nc</dataSource>
       </dataFile>
      <dataFile label="input" target="INPUT/init_ocean_cobalt.res.nc" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/ESM4/OBGC/IC/mom4p1_restart_to_latlon_360x180/ESM2M_pi-control_C2_cobalt_latlon_360x180_15010101_nobounds_mumem_htotalbounds.ocean_cobalt.res.nc</dataSource>
      </dataFile>
     <dataFile label="input" target="INPUT/init_ocean_cobalt_phyto_biomass.res.nc" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/ESM4/OBGC/IC/BLING/ESM2M_pi-control_C2_cobalt_latlon_360x180_15010101_nobounds_mumem_htotalbounds.ocean_cobalt_phyto_biomass.res.nc</dataSource>
     </dataFile>

      <!-- Generic Abiotic Input Files -->
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(KRASTING)/cwg/input/abiotic/GLODAPv1.abiotic.filled.20180316.nc</dataSource>
      </dataFile>

    </input>
  </freInclude>

    <freInclude name="CFC_data_table">
    <input>
      <!--CFCs/SF6 Boundary Conditions -->
      <dataFile label="input" target="INPUT/cfc.bc.nc" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(KRASTING)/cwg/input/cfc/CFC_histories_revised_2015_20x20deg.20171208.nc</dataSource>
      </dataFile>

      <dataTable order="append">
#CFCs
"ATM", "cfc11_flux_pcair_atm","CFC11","INPUT/cfc.bc.nc","bilinear", 1.0e-12
"ATM", "cfc12_flux_pcair_atm","CFC12","INPUT/cfc.bc.nc","bilinear", 1.0e-12
"ATM", "sf6_flux_pcair_atm",   "SF6",  "INPUT/cfc.bc.nc","bilinear", 1.0e-12
      </dataTable>  
    </input>
    </freInclude>

    <freInclude name="ABIO_data_table">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(KRASTING)/cwg/input/abiotic/atm_delta_13C_14C.nc</dataSource>
      </dataFile>

      <dataTable order="append">
#Abiotic
"OCN", "delta_14catm", "D14C", "./INPUT/atm_delta_13C_14C.nc",  "bilinear", 1.0
"ATM", "abco2_flux_pcair_atm", "" , "", "none" ,284.262e-6
"ATM", "ab14co2_flux_pcair_atm", "", "", "none" ,284.262e-6
      </dataTable>  
    </input>
    </freInclude>

    <freInclude name="ABIO_field_table">
    <input>
      <fieldTable order="append">
"namelists","ocean_mod","generic_abiotic"
init = f
ab_htotal_src_file = INPUT/init_ocean_cobalt.res.nc
ab_htotal_src_var_name = htotal
ab_htotal_src_var_unit = none
ab_htotal_dest_var_name =  ab_htotal
ab_htotal_dest_var_unit = mol kg-1
ab_htotal_src_var_record = 1
ab_htotal_src_var_gridspec = NONE
ab_htotal_valid_min = 3.981E-09
ab_htotal_valid_max = 1.259E-08
#
ab_htotal14c_src_file = INPUT/init_ocean_cobalt.res.nc
ab_htotal14c_src_var_name = htotal
ab_htotal14c_src_var_unit = none
ab_htotal14c_dest_var_name =  ab_htotal
ab_htotal14c_dest_var_unit = mol kg-1
ab_htotal14c_src_var_record = 1
ab_htotal14c_src_var_gridspec = NONE
ab_htotal14c_valid_min = 3.981E-09
ab_htotal14c_valid_max = 1.259E-08
#
## divide by 1e6 to convert from umol/kg to mol/kg
dissicabio_src_file = INPUT/GLODAPv1.abiotic.filled.20180316.nc
dissicabio_src_var_name = preind_dic_abiotic
dissicabio_src_var_unit = micromoles_per_kg
dissicabio_dest_var_name =  dissicabio
dissicabio_dest_var_unit = mol kg-1
dissicabio_src_var_record = 1
dissicabio_src_var_gridspec = NONE
dissicabio_valid_min = 0.0
#
## divide by 1e6 to convert from umol/kg to mol/kg
dissi14cabio_src_file = INPUT/GLODAPv1.abiotic.filled.20180316.nc
dissi14cabio_src_var_name = preind_di14c
dissi14cabio_src_var_unit = micromoles_per_kg
dissi14cabio_dest_var_name =  dissi14cabio
dissi14cabio_dest_var_unit = mol kg-1
dissi14cabio_src_var_record = 1
dissi14cabio_src_var_gridspec = NONE
dissi14cabio_valid_min = 0.0
/
     </fieldTable>
    </input>
    </freInclude>

    <freInclude name="BLING_data_table">
    <input>

      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource platform="$(platform)">$(CMIP6_ARCHIVE_ROOT)/ESM4/OBGC/BC/TOPAZ/deposition_fan/Soluble_Fe_Flux_PI.nc</dataSource>
      </dataFile>

      <dataTable order="append">
"ATM", "c14o2_flux_pcair_atm",         "",      "",                                "none",  284.262e-06
"ATM", "co2_flux_pcair_atm",           "",      "",                                "none",  284.262e-06
"ATM", "o2_flux_pcair_atm",            "",      "",                                "none",    0.21
"OCN", "runoff_alk_flux_ice_ocn",      "",      "",                                "none",    0.5932e-3
"OCN", "runoff_dic_flux_ice_ocn",      "",      "",                                "none",    0.96e-3
"OCN", "runoff_po4_flux_ice_ocn",      "",      "",                                "none",    0.006792e-3
"OCN", "dry_dep_fed_flux_ice_ocn",     "FLUX",  "./INPUT/Soluble_Fe_Flux_PI.nc",   "bilinear",   -1.0
      </dataTable>  
    </input>
  </freInclude>

    <freInclude name="BLING_field_table">
    <input>
      <!-- BLING field table (GLODAPv1 Preind DIC) -->
      <fieldTable order="append">
####.................................................
### atmos co2 field table for CMIP6 Jan 1 1850
## jgj 2016/11/29

# CO2 tracer
## Note: atm transport and land model expect moist mmr.
##       set co2 units: kg/kg  (mass mixing ratio) for both atm and lnd field table entries.
##       convert atm IC field table entry from dry vmr value to **dry** mmr
## Note: for atm cold start from constant co2 value, instead of using field table to initialize co2,
##       create atmos_tracers.res.nc with co2 moist mmr values
##       WTMAIR = 2.896440E+01 WTMCO2   =  44.00995
##       CMIP6 Jan 1 1850 co2 = 284.262e-6
#
 

###.................................................
### BLING field table 
## jgj 2013/01/23 updated for BLING

"namelists","ocean_mod","generic_bling/*global*"
/

"namelists","ocean_mod","generic_bling"

init = f
ca_2_p = 1.06
#--------------------------------------------------------------------
# JGJ 2017/01/31
# field table entries for initialization of cobalt/bling tracers
# all unit conversions will be specified in the code based on
# valid src_var_unit and internal model unit.
# If field table src_var_unit does not match valid src_var_unit
# in code, model will give fatal error.
# valid src_var_units:
#    NO3, PO4, SiO4    : micromoles_per_liter
#    O2                : milliliters_per_liter
#    DIC, ALK          : micromoles_per_kg
#    all other fields  : none
# valid src_var_record : 0-12, where 0 is Annual, 1-12 for Jan-Dec
# 2015/10/05: Use annual data for WOA13 N, P, Si, O2 since monthly data does not extend to depth
# airsea and ice_ocean fluxes are handled by coupler, so are initialized in COBALT/BLING.
# 
# 2015/09/28 jgj updated to provide valid_min, valid_max for tracers to ensure
# tracers remain positive after interpolation
# note that values of valid_min and valid_max are in model units not src_units
# currently only alk, dic and htotal have both a valid_min and valid_max
# specified in field_table, but valid_max is ignored for now by code.
# as of 2015/10/06 src_var_record and src_var_gridspec are not yet implemented
#
# 2015/10/14 change valid_min for alk and dic to 0 since land values get filled with valid_min
#            also remove valid_max for alk and dic
#
# BLING needs: dic, alk, po4, o2, dop, fed, htotal, co3_ion, irr_mem, biomass_p, chl
# optional needs: po4_pre, alk_pre, dic_pre, dic_sat, htotal_sat, di14c, do14c
# dop = srdop in cobalt
# biomass = phytoplankton biomass = (nlg+nsm+ndi in COBALT) 
#------------------------------------------------------------------------------------------------
#
# O2 from WOA2013  (/archive/mdteam/obs/NOAA-NODC/WOA13/v1.00a/woa13_all_o_annual_01.nc)
# min = 0, max = 15.44 from input dataset
# multiply by (1000/22391.6)/1035 to convert from ml/l to mol/kg
o2_src_file = INPUT/woa13_all_o_annual_01.nc
o2_src_var_name = o_an
o2_src_var_unit = milliliters_per_liter
o2_dest_var_name =  o2
o2_dest_var_unit = mol kg-1
o2_src_var_record = 1
o2_src_var_gridspec = NONE
o2_valid_min = 0.0
#
# PO4 from WOA2013  (/archive/mdteam/obs/NOAA-NODC/WOA13/v1.00a/woa13_all_p_annual_01.nc)
# min = 0, max = 9.757 from input dataset
# divide by 1035e3 to convert from umol/l to mol/kg
po4_src_file = INPUT/woa13_all_p_annual_01.nc
po4_src_var_name = p_an
po4_src_var_unit = micromoles_per_liter
po4_dest_var_name =  po4
po4_dest_var_unit = mol kg-1
po4_src_var_record = 1
po4_src_var_gridspec = NONE
po4_valid_min = 0.0
#
# PO4_pre from WOA2013  (/archive/mdteam/obs/NOAA-NODC/WOA13/v1.00a/woa13_all_p_annual_01.nc)
# min = 0, max = 9.757 from input dataset
# divide by 1035e3 to convert from umol/l to mol/kg
po4_pre_src_file = INPUT/woa13_all_p_annual_01.nc
po4_pre_src_var_name = p_an
po4_pre_src_var_unit = micromoles_per_liter
po4_pre_dest_var_name =  po4_pre
po4_pre_dest_var_unit = mol kg-1
po4_pre_src_var_record = 1
po4_pre_src_var_gridspec = NONE
po4_pre_valid_min = 0.0
#
# Alkalinity from GLODAP  (/archive/jgj/datasets/retrospective/glodap/20151013/Alk.nc)
# min = 2171, max = 2462 from input dataset
# divide by 1e6 to convert from umol/kg to mol/kg
alk_src_file = INPUT/Alk.nc
alk_src_var_name = Alk
alk_src_var_unit = micromoles_per_kg
alk_dest_var_name =  alk
alk_dest_var_unit = mol kg-1
alk_src_var_record = 1
alk_src_var_gridspec = NONE
alk_valid_min = 0.0
#
# alk_pre Alkalinity from GLODAP  (/archive/jgj/datasets/retrospective/glodap/20151013/Alk.nc)
# min = 2171, max = 2462 from input dataset
# divide by 1e6 to convert from umol/kg to mol/kg
alk_pre_src_file = INPUT/Alk.nc
alk_pre_src_var_name = Alk
alk_pre_src_var_unit = micromoles_per_kg
alk_pre_dest_var_name =  alk_pre
alk_pre_dest_var_unit = mol kg-1
alk_pre_src_var_record = 1
alk_pre_src_var_gridspec = NONE
alk_pre_valid_min = 0.0
#
# Preind DIC from GLODAP  (/archive/jgj/datasets/retrospective/glodap/20151013/Preind_DIC.nc)
# min = 1837, max = 2406 from input dataset
# divide by 1e6 to convert from umol/kg to mol/kg
dic_src_file = INPUT/Preind_DIC.nc
dic_src_var_name = Preind_DIC
dic_src_var_unit = micromoles_per_kg
dic_dest_var_name =  dic 
dic_dest_var_unit = mol kg-1
dic_src_var_record = 1
dic_src_var_gridspec = NONE
dic_valid_min = 0.0
#
# dic_pre from Preind DIC from GLODAP  (/archive/jgj/datasets/retrospective/glodap/20151013/Preind_DIC.nc)
# min = 1837, max = 2406 from input dataset
# divide by 1e6 to convert from umol/kg to mol/kg
dic_pre_src_file = INPUT/Preind_DIC.nc
dic_pre_src_var_name = Preind_DIC
dic_pre_src_var_unit = micromoles_per_kg
dic_pre_dest_var_name =  dic_pre 
dic_pre_dest_var_unit = mol kg-1
dic_pre_src_var_record = 1
dic_pre_src_var_gridspec = NONE
dic_pre_valid_min = 0.0
#
# dic_sat from Preind DIC from GLODAP  (/archive/jgj/datasets/retrospective/glodap/20151013/Preind_DIC.nc)
# min = 1837, max = 2406 from input dataset
# divide by 1e6 to convert from umol/kg to mol/kg
dic_sat_src_file = INPUT/Preind_DIC.nc
dic_sat_src_var_name = Preind_DIC
dic_sat_src_var_unit = micromoles_per_kg
dic_sat_dest_var_name =  dic_sat 
dic_sat_dest_var_unit = mol kg-1
dic_sat_src_var_record = 1
dic_sat_src_var_gridspec = NONE
dic_sat_valid_min = 0.0
#
# di14c from Preind DIC from GLODAP  (/archive/jgj/datasets/retrospective/glodap/20151013/Preind_DIC.nc)
# min = 1837, max = 2406 from input dataset
# divide by 1e6 to convert from umol/kg to mol/kg
di14c_src_file = INPUT/Preind_DIC.nc
di14c_src_var_name = Preind_DIC
di14c_src_var_unit = micromoles_per_kg
di14c_dest_var_name =  di14c
di14c_dest_var_unit = mol kg-1
di14c_src_var_record = 1
di14c_src_var_gridspec = NONE
di14c_valid_min = 0.0
#
# do14c from Preind DIC from GLODAP  (/archive/jgj/datasets/retrospective/glodap/20151013/Preind_DIC.nc)
# min = 1837, max = 2406 from input dataset
# divide by 1e6 to convert from umol/kg to mol/kg
do14c_src_file = INPUT/Preind_DIC.nc
do14c_src_var_name = Preind_DIC
do14c_src_var_unit = micromoles_per_kg
do14c_dest_var_name =  do14c
do14c_dest_var_unit = mol kg-1
do14c_src_var_record = 1
do14c_src_var_gridspec = NONE
do14c_valid_min = 0.0
#
# additional tracers from ESM2M-COBALT Preindustrial Control restart (/archive/jgj/datasets/retrospective/mom4p1_restart_to_latlon_360x180/ESM2M_pi-control_C2_cobalt_latlon_360x180_15010101_nobounds_mumem_htotalbounds.ocean_cobalt.res.nc)
#
# min = 0 from input dataset
cased_src_file = INPUT/init_ocean_cobalt.res.nc
cased_src_var_name = cased
cased_src_var_unit = none
cased_dest_var_name =  cased
cased_dest_var_unit = mol kg-1
cased_src_var_record = 1
cased_src_var_gridspec = NONE
cased_valid_min = 0.0
#
# min = 0,  max = 4.446 from input dataset
chl_src_file = INPUT/init_ocean_cobalt.res.nc
chl_src_var_name = chl
chl_src_var_unit = none
chl_dest_var_name =  chl
chl_dest_var_unit = mol kg-1
chl_src_var_record = 1
chl_src_var_gridspec = NONE
chl_valid_min = 0.0
#
# min = 0,  max = 3.576E-04 from input dataset
co3_ion_src_file = INPUT/init_ocean_cobalt.res.nc
co3_ion_src_var_name = co3_ion
co3_ion_src_var_unit = none
co3_ion_dest_var_name =  co3_ion
co3_ion_dest_var_unit = mol kg-1
co3_ion_src_var_record = 1
co3_ion_src_var_gridspec = NONE
co3_ion_valid_min = 0.0
#
# min = -1.758E-11,  max = 1.758E-08 from input dataset
fed_src_file = INPUT/init_ocean_cobalt.res.nc
fed_src_var_name = fed
fed_src_var_unit = none
fed_dest_var_name =  fed
fed_dest_var_unit = mol kg-1
fed_src_var_record = 1
fed_src_var_gridspec = NONE
fed_valid_min = 0.0
#
# min = 10^-8.4=3.981E-09,  max = 10^-7.9 = 1.259E-08 from input dataset
htotal_src_file = INPUT/init_ocean_cobalt.res.nc
htotal_src_var_name = htotal
htotal_src_var_unit = none
htotal_dest_var_name =  htotal
htotal_dest_var_unit = mol kg-1
htotal_src_var_record = 1
htotal_src_var_gridspec = NONE
htotal_valid_min = 3.981E-09
htotal_valid_max = 1.259E-08
#
# htotal_sat identical to htotal
htotal_sat_src_file = INPUT/init_ocean_cobalt.res.nc
htotal_sat_src_var_name = htotal
htotal_sat_src_var_unit = none
htotal_sat_dest_var_name =  htotal_sat
htotal_sat_dest_var_unit = mol kg-1
htotal_sat_src_var_record = 1
htotal_sat_src_var_gridspec = NONE
htotal_sat_valid_min = 3.981E-09
htotal_sat_valid_max = 1.259E-08
#
# min = 0,  max = 137.7 from input dataset
irr_mem_src_file = INPUT/init_ocean_cobalt.res.nc
irr_mem_src_var_name = irr_mem
irr_mem_src_var_unit = none
irr_mem_dest_var_name =  irr_mem
irr_mem_dest_var_unit = mol kg-1
irr_mem_src_var_record = 1
irr_mem_src_var_gridspec = NONE
irr_mem_valid_min = 0.0
#
# min = -1.257E-11,  max = 3.831E-07 from input dataset
dop_src_file = INPUT/init_ocean_cobalt.res.nc
dop_src_var_name = srdop
dop_src_var_unit = none
dop_dest_var_name =  dop
dop_dest_var_unit = mol kg-1
dop_src_var_record = 1
dop_src_var_gridspec = NONE
dop_valid_min = 0.0
#
# phyto biomass
biomass_p_src_file = INPUT/init_ocean_cobalt_phyto_biomass.res.nc
biomass_p_src_var_name = phyto_biomass
biomass_p_src_var_unit = none
biomass_p_dest_var_name =  biomass_p
biomass_p_dest_var_unit = mol kg-1
biomass_p_src_var_record = 1
biomass_p_src_var_gridspec = NONE
biomass_p_valid_min = 0.0
#
/
###........................................
      </fieldTable>  
    </input>
  </freInclude>

  <freInclude name="diag_table_GENERICS">
    <input>
      <diagTable order="append">
#======================================================================================
# Ocean Inert Chemistry Diagnostics
"ocean_inert",           1, "months", 1, "days", "time",
"ocean_inert_z",         1, "months", 1, "days", "time",
"ocean_inert_annual",    12, "months", 1, "days", "time",
"ocean_inert_annual_z",  12, "months", 1, "days", "time",

#
"generic_cfc",    "cfc11",    "cfc11",    "ocean_inert",          "all",.true.,"none",2
"generic_cfc_z",  "cfc11",    "cfc11",    "ocean_inert_z",        "all",.true.,"none",2
"generic_cfc",    "cfc11",    "cfc11",    "ocean_inert_annual",   "all",.true.,"none",2
"generic_cfc_z",  "cfc11",    "cfc11",    "ocean_inert_annual_z", "all",.true.,"none",2
"generic_cfc",    "fgcfc11",  "fgcfc11",  "ocean_inert",          "all",.true.,"none",2

"generic_cfc",    "cfc12",    "cfc12",    "ocean_inert",          "all",.true.,"none",2
"generic_cfc_z",  "cfc12",    "cfc12",    "ocean_inert_z",        "all",.true.,"none",2
"generic_cfc",    "cfc12",    "cfc12",    "ocean_inert_annual",   "all",.true.,"none",2
"generic_cfc_z",  "cfc12",    "cfc12",    "ocean_inert_annual_z", "all",.true.,"none",2
"generic_cfc",    "fgcfc12",  "fgcfc12",  "ocean_inert",          "all",.true.,"none",2

"generic_sf6",    "sf6",      "sf6",      "ocean_inert",          "all",.true.,"none",2
"generic_sf6_z",  "sf6",      "sf6",      "ocean_inert_z",        "all",.true.,"none",2
"generic_sf6",    "sf6",      "sf6",      "ocean_inert_annual",   "all",.true.,"none",2
"generic_sf6_z",  "sf6",      "sf6",      "ocean_inert_annual_z", "all",.true.,"none",2
"generic_sf6",    "fgsf6",    "fgsf6",    "ocean_inert",          "all",.true.,"none",2

"generic_cfc",   "cfc11_alpha",     "cfc11_alpha",     "ocean_inert","all",.true.,"none",2
"generic_cfc",   "cfc11_csurf",     "cfc11_csurf",     "ocean_inert","all",.true.,"none",2
"generic_cfc",   "cfc11_sc_no",     "cfc11_sc_no",     "ocean_inert","all",.true.,"none",2
"generic_cfc",   "cfc11_stf_gas",   "cfc11_stf_gas",   "ocean_inert","all",.true.,"none",2
"generic_cfc",   "cfc12_alpha",     "cfc12_alpha",     "ocean_inert","all",.true.,"none",2
"generic_cfc",   "cfc12_csurf",     "cfc12_csurf",     "ocean_inert","all",.true.,"none",2
"generic_cfc",   "cfc12_sc_no",     "cfc12_sc_no",     "ocean_inert","all",.true.,"none",2
"generic_cfc",   "cfc12_stf_gas",   "cfc12_stf_gas",   "ocean_inert","all",.true.,"none",2
"generic_sf6",   "sf6_alpha",       "sf6_alpha",       "ocean_inert","all",.true.,"none",2
"generic_sf6",   "sf6_csurf",       "sf6_csurf",       "ocean_inert","all",.true.,"none",2
"generic_sf6",   "sf6_sc_no",       "sf6_sc_no",       "ocean_inert","all",.true.,"none",2
"generic_sf6",   "sf6_stf_gas",     "sf6_stf_gas",     "ocean_inert","all",.true.,"none",2

"ocean_abiotic",           1, "months", 1, "days", "time",
"ocean_abiotic_z",          1, "months", 1, "days", "time",
"ocean_abiotic_annual",   12, "months", 1, "days", "time",
"ocean_abiotic_annual_z",  12, "months", 1, "days", "time",

#
#-- CMIP Tracer Fields
"generic_abiotic",   "dissicabio",           "dissicabio",           "ocean_abiotic","all",.true.,"none", 2
"generic_abiotic",   "dissi14cabio",         "dissi14cabio",         "ocean_abiotic","all",.true.,"none", 2
"generic_abiotic",   "phabio",               "phabio",               "ocean_abiotic","all",.true.,"none", 2
"generic_abiotic_z", "dissicabio",           "dissicabio",           "ocean_abiotic_z","all",.true.,"none", 2
"generic_abiotic_z", "dissi14cabio",         "dissi14cabio",         "ocean_abiotic_z","all",.true.,"none", 2
"generic_abiotic_z", "phabio",               "phabio",               "ocean_abiotic_z","all",.true.,"none", 2
"generic_abiotic",   "dissicabio",           "dissicabio",           "ocean_abiotic_annual","all",.true.,"none", 2
"generic_abiotic",   "dissi14cabio",         "dissi14cabio",         "ocean_abiotic_annual","all",.true.,"none", 2
"generic_abiotic",   "phabio",               "phabio",               "ocean_abiotic_annual","all",.true.,"none", 2
"generic_abiotic_z", "dissicabio",           "dissicabio",           "ocean_abiotic_annual_z","all",.true.,"none", 2
"generic_abiotic_z", "dissi14cabio",         "dissi14cabio",         "ocean_abiotic_annual_z","all",.true.,"none", 2
"generic_abiotic_z", "phabio",               "phabio",               "ocean_abiotic_annual_z","all",.true.,"none", 2

#-- CMIP Surface Fields
"generic_abiotic",   "dissicabioos",         "dissicabioos",         "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "dissi14cabioos",       "dissi14cabioos",       "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "dpco2abio",            "dpco2abio",            "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "fgco2abio",            "fgco2abio",            "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "fg14co2abio",          "fg14co2abio",          "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "phabioos",             "phabioos",             "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "spco2abio",            "spco2abio",            "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "fgco2abio",            "fgco2abio",            "ocean_abiotic_annual","all",.true.,"none",2
"generic_abiotic",   "fg14co2abio",          "fg14co2abio",          "ocean_abiotic_annual","all",.true.,"none",2

#-- Non-CMIP Tracer Fields
"generic_abiotic",   "ab_alk",               "ab_alk",               "ocean_abiotic","all",.true.,"none", 2
"generic_abiotic",   "ab_htotal",            "ab_htotal",            "ocean_abiotic","all",.true.,"none", 2
"generic_abiotic",   "ab_htotal14c",         "ab_htotal14c",         "ocean_abiotic","all",.true.,"none", 2
"generic_abiotic",   "ab_po4",               "ab_po4",               "ocean_abiotic","all",.true.,"none", 2
"generic_abiotic",   "ab_sio4",              "ab_sio4",              "ocean_abiotic","all",.true.,"none", 2
"generic_abiotic",   "jdecay_di14c",         "jdecay_di14c",         "ocean_abiotic","all",.true.,"none", 2
"generic_abiotic_z", "ab_alk",               "ab_alk",               "ocean_abiotic_z","all",.true.,"none",2
"generic_abiotic_z", "ab_htotal",            "ab_htotal",            "ocean_abiotic_z","all",.true.,"none",2
"generic_abiotic_z", "ab_htotal14c",         "ab_htotal14c",         "ocean_abiotic_z","all",.true.,"none",2
"generic_abiotic_z", "ab_po4",               "ab_po4",               "ocean_abiotic_z","all",.true.,"none",2
"generic_abiotic_z", "ab_sio4",              "ab_sio4",              "ocean_abiotic_z","all",.true.,"none",2

#-- Non-CMIP Surface Fields
"generic_abiotic",   "sfc_ab_alk",           "sfc_ab_alk",           "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "sfc_ab_htotal",        "sfc_ab_htotal",        "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "sfc_ab_htotal14c",     "sfc_ab_htotal14c",     "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "sfc_ab_po4",           "sfc_ab_po4",           "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "sfc_ab_sio4",          "sfc_ab_sio4",          "ocean_abiotic","all",.true.,"none",2

#-- Non-CMIP Gas exchange
"generic_abiotic",   "ab_pco2surf",          "ab_pco2surf",          "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "ab_p14co2surf",        "ab_p14co2surf",        "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "delta_14catm",         "delta_14catm",         "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "dissicabio_alpha",     "dissicabio_alpha",     "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "dissi14cabio_alpha",   "dissi14cabio_alpha",   "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "dissicabio_csurf",     "dissicabio_csurf",     "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "dissi14cabio_csurf",   "dissi14cabio_csurf",   "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "dissicabio_sc_no",     "dissicabio_sc_no",     "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "dissi14cabio_sc_no",   "dissi14cabio_sc_no",   "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "dissicabio_stf_gas",   "dissicabio_stf_gas",   "ocean_abiotic","all",.true.,"none",2
"generic_abiotic",   "dissi14cabio_stf_gas", "dissi14cabio_stf_gas", "ocean_abiotic","all",.true.,"none",2
# Required cell measures
"ocean_model",  "volcello", "volcello",  "ocean_abiotic","all","mean","none",2 # Cell measure for 3d data
"ocean_model_z","volcello", "volcello",  "ocean_abiotic_z","all","mean","none",2 # Cell measure for 3d data
"ocean_model",  "volcello", "volcello",  "ocean_abiotic_annual","all","mean","none",2 # Cell measure for 3d data
"ocean_model_z", "volcello", "volcello", "ocean_abiotic_annual_z","all","mean","none",2 # Cell measure for 3d data
"ocean_model",  "volcello", "volcello",  "ocean_inert","all","mean","none",2 # Cell measure for 3d data
"ocean_model_z","volcello", "volcello",  "ocean_inert_z","all","mean","none",2 # Cell measure for 3d data
"ocean_model",  "volcello", "volcello",  "ocean_inert_annual","all","mean","none",2 # Cell measure for 3d data
"ocean_model_z","volcello", "volcello",  "ocean_inert_annual_z","all","mean","none",2 # Cell measure for 3d data
     </diagTable>
    </input>
  </freInclude>

   <!--OM4 CORE2 dynamic forcing datasets-->
   <freInclude name="CORE2_IAF_data">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">/lustre/f2/pdata/gfdl/gfdl_O/datasets/CORE/IAF_v2.0/ncar_precip.1948-2007.nomads.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">/lustre/f2/pdata/gfdl/gfdl_O/datasets/CORE/IAF_v2.0/ncar_rad.1948-2007.nomads.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">/lustre/f2/pdata/gfdl/gfdl_O/datasets/CORE/IAF_v2.0/q_10_mod.1948-2007.nomads.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">/lustre/f2/pdata/gfdl/gfdl_O/datasets/CORE/IAF_v2.0/slp.1948-2007.nomads.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">/lustre/f2/pdata/gfdl/gfdl_O/datasets/CORE/IAF_v2.0/t_10_mod.1948-2007.nomads.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">/lustre/f2/pdata/gfdl/gfdl_O/datasets/CORE/IAF_v2.0/u_10_mod.1948-2007.nomads.nc</dataSource>
      </dataFile>      
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">/lustre/f2/pdata/gfdl/gfdl_O/datasets/CORE/IAF_v2.0/v_10_mod.1948-2007.nomads.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
         <dataSource platform="$(platform)">$(MOM6_EXAMPLES)/ice_ocean_SIS2/SIS2/INPUT/cfc.bc.nc</dataSource>
      </dataFile>
    </input>
   </freInclude>

   <!-- OCEAN  and ICE post-processing-->
   <freInclude name="OM4p125_postprocess">
      <postProcess> 
         <csh><![CDATA[
         cd $work
         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results
         mv *velocity_truncations MOM_parameter_doc* SIS_parameter_doc* seaice.stats* ocean.stats* extra.results/

         #When the ocean uses a mask_table the ocean_static.nc file produced by the model run has holes in coordinates (geolon,geolat)
         #This causes problems for ferret and python tools for analysis.
         #Copy a non-masked version of ocean_static.nc to be saved as a history file to be used by the analysis scipts . 
         #cp $work/INPUT/ocean_static_no_mask_table.nc $work/
#bronx-15 does not let us do this copy! outputstager.HS jobs fail with
#*ERROR*: An ocean mask file was specified, so the output.stager was configured to swap in unmasked grid info into the ocean_static.nc history file. Unfortunately, there were multiple *.ocean_static.nc targets for unmasked lat/lon swap, but there should be just one. This shouldn't happen, so please open a help desk ticket. Alternatively, to temporarily disable this feature, change argFile actionFillGridOn = 0, or in the runscript, delete the variable flagOutputFillGridOn.


         ]]></csh>

      <!--REFINE DIAG SCRIP -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh  $(NB_ROOT)/mdt_xml/awg_include/refineDiag/refineDiag_data_stager_globalAve.csh"/>

      <!--PostProcessing component models-->
      <component type="ocean_daily"   start="$(PP_START_YEAR)" source="ocean_daily" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_daily"/>
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_daily"/>
      </component>
      <component type="ocean_monthly_z_d2" start="$(PP_START_YEAR)"  source="ocean_month_z_d2" sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month_z_d2"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)"/>
      </component>
      <component type="ocean_annual_rho2_d2"  start="$(PP_START_YEAR)" source="ocean_annual_rho2_d2" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual"   chunkLength="$(CHUNK_LENGTH_B)" source="ocean_annual_rho2_d2"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_annual_z" start="$(PP_START_YEAR)" source="ocean_annual_z"  sourceGrid="ocean-tripolar">
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual_z.frepp"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual_z.frepp"/>
        </timeAverage>
        <timeSeries freq="annual"  chunkLength="$(CHUNK_LENGTH_B)" source="ocean_annual_z"/>	
      </component>
      <component type="ocean_annual_z_d2" start="$(PP_START_YEAR)" source="ocean_annual_z_d2"  sourceGrid="ocean-tripolar">
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual_z.frepp"/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual_z.frepp"/>
        </timeAverage>
        <timeSeries freq="annual"  chunkLength="$(CHUNK_LENGTH_B)" source="ocean_annual_z_d2"/>	
      </component>

      <!--Ocean scalars-->
      
      <component type="ocean_scalar_annual"  start="$(PP_START_YEAR)" source="ocean_scalar_annual" sourceGrid="ocean-tripolar">
        <timeSeries freq="annual"   chunkLength="$(CHUNK_LENGTH_B)" source="ocean_scalar_annual"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
      </component>


      <!--ICE-->      
      <component type="ice"  start="$(PP_START_YEAR)"  source="ice_month"  sourceGrid="ocean-tripolar">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month">
	   <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/tools/analysis/Krasting-SeaIce.csh"/>
	</timeSeries>   
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month">
           <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/tools/analysis/Krasting-SeaIce.csh"/>
        </timeSeries>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
	  
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
      </component>
     </postProcess>
   </freInclude>

   <freInclude name="OM4_postprocess">
      <postProcess> 
         <csh><![CDATA[
	 #Take care of iceberg restarts and trajectories
         cd $work/RESTART
         #Treat icebergs restarts and trajectories
         #Find non-empty iceberg restarts and combine them AND then remove uncombined restarts
         #This should be handled properly by FRE
         #ncrcat icebergs.res.nc.* icebergs.res.nc
      ls icebergs.res.nc.*
      if( ! $status ) then
         which ncdump
         if( $status ) then
           echo ncdump not available! We need to stop the run or the model restarts incorrectly!
           exit 1
         endif

         set non_empty_restarts = ""
         foreach file ( `ls icebergs.res.nc.????` )
            if ( `ncdump -h $file | grep UNLIMITED | awk '{gsub(/\(/," ");print $6}'` ) set non_empty_restarts = "$non_empty_restarts $file"
         end
         if( "$non_empty_restarts" != "" ) then
          ncrcat $non_empty_restarts icebergs.res.nc
          if( ! -e icebergs.res.nc ) then
            echo ERROR: ncrcat did not produce icebergs restart file! We need to stop the run or the model restarts incorrectly!
            exit 1
          endif
         endif

         mkdir hide_from_fre
         mv icebergs.res.nc.* hide_from_fre/
         cd $work
         mkdir hide_from_fre
         ncrcat iceberg_trajectories.nc.* iceberg_trajectories.nc
         mv iceberg_trajectories.nc.* hide_from_fre/
      endif

         cd $work
         #Make a directory to trick FRE to pick up and archive in ascii
         mkdir extra.results
         mv *velocity_truncations MOM_parameter_doc* SIS_parameter_doc* seaice.stats* ocean.stats* extra.results/

         #When the ocean uses a mask_table the ocean_static.nc file produced by the model run has holes in coordinates (geolon,geolat)
         #This causes problems for ferret and python tools for analysis.
         #Copy a non-masked version of ocean_static.nc to be saved as a history file to be used by the analysis scipts . 
         #cp $work/INPUT/ocean_static_no_mask_table.nc $work/

         ]]></csh>

      <!--REFINE DIAG SCRIP -->
      <!--By default a refineDiag script causes the annual data to be unpacked and saved in /ptmp/$USER-->
      <refineDiag script="$(NB_ROOT)/mom6/tools/analysis/MOM6_refineDiag.csh  $(NB_ROOT)/mdt_xml/awg_include/refineDiag/refineDiag_data_stager_globalAve.csh"/>

      <!--PostProcessing component models-->
      <component type="ocean_daily"   start="$(PP_START_YEAR)" source="ocean_daily" sourceGrid="ocean-tripolar" cmip="off">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_daily"/>
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_daily"/>
      </component>
      <component type="ocean_daily_cmip" source="ocean_daily" sourceGrid="ocean-tripolar" cmip="on">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_A)">
          <variables>sos tos zos</variables>
        </timeSeries>
      </component>
      <component type="ocean_daily_gfdl" source="ocean_daily" sourceGrid="ocean-tripolar" cmip="off">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_A)">
          <variables>chlos sossq tossq ssu ssv omldamax</variables>
        </timeSeries>
      </component>

      <component type="ocean_daily_1x1deg" source="ocean_daily" sourceGrid="ocean-tripolar" xyInterp="180,360" cmip="on">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_A)"/>
      </component>

      <component type="ocean_monthly"   start="$(PP_START_YEAR)" source="ocean_month" sourceGrid="ocean-tripolar" cmip="off">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_monthly.frepp"/>
        </timeSeries>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_monthly.frepp"/>
        </timeSeries> 
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
      </component>
      <component type="ocean_monthly_1x1deg" source="ocean_month" sourceGrid="ocean-tripolar" xyInterp="180,360" cmip="on">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)">
          <variables>
              evs                   ficeberg               friver                 heat_content_cond
              heat_content_fprec    heat_content_massin    heat_content_massout   heat_content_surfwater
              Heat_PmE               hfds                   hfevapds
              hfibthermds           hflso                  hfrainds               hfrunoffds
              hfsifrazil            hfsnthermds            hfsso
              LwLatSens             MLD_003                MLD_restrat            mlotstmax
              mlotstmin             mlotst                 mlotstsq               MSTAR
              net_heat_coupler      net_massin             net_massout            nonpenSW
              pbo                   prlq                   prsn                   pso
              rlntds                rsntds                 sfdsi                  sob
              sos                   sossq                  tob                    tos
              tossq                 ustar                  wfo                    zos
              zossq
          </variables>
        </timeSeries>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
      </component>

<!-- added by h1g 20171002 -->
      <component type="ocean_month_rho2" source="ocean_month_rho2" sourceGrid="ocean-tripolar" cmip="off">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)">
        </timeSeries>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
      </component>
      <component type="ocean_month_rho2_1x1deg" source="ocean_month_rho2" sourceGrid="ocean-tripolar" xyInterp="180,360" cmip="off">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)">
        </timeSeries>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
      </component>
<!-- 20171002 -->

      <component type="ocean_monthly_z" start="$(PP_START_YEAR)"  source="ocean_month_z" sourceGrid="ocean-tripolar" cmip="on">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)"/>
      </component>
      <component type="ocean_monthly_z_1x1deg" source="ocean_month_z" sourceGrid="ocean-tripolar" xyInterp="180,360" cmip="on">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
      </component>

      <component type="ocean_annual_z" start="$(PP_START_YEAR)" source="ocean_annual_z"  sourceGrid="ocean-tripolar" cmip="on">
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual_z.frepp"/>
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="yes" script="$(AWG_INPUT_HOME)/analysis/stub/atw_ocean_av_annual_subsfc_ocean.csh -D ocean_annual_z.%04d-%04d."/>
        </timeAverage>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual_z.frepp"/>
        </timeAverage>
        <timeSeries freq="annual"  chunkLength="$(CHUNK_LENGTH_A)" source="ocean_annual_z"/>	
      </component>

      <component type="ocean_annual_z_1x1deg" source="ocean_annual_z" sourceGrid="ocean-tripolar" xyInterp="180,360" cmip="on">
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
      </component>

      <component type="ocean_annual" start="$(PP_START_YEAR)"  source="ocean_annual"  sourceGrid="ocean-tripolar" cmip="on"> 
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual.frepp"/>
        </timeAverage>
        <timeAverage source="annual" interval="10yr"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)">
          <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/$(OM4_ANALYSIS)/ocn_annual.frepp"/>
        </timeAverage>
      </component>

      <component type="ocean_annual_1x1deg" source="ocean_annual" sourceGrid="ocean-tripolar" xyInterp="180,360" cmip="on">
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)">
          <variables>
             boundary_forcing_heat_tendency_2d  boundary_forcing_salt_tendency_2d  dispkexyfo evs  ficeberg  frazil_heat_tendency_2d
             friver                             heat_content_cond                           heat_content_fprec        heat_content_massin
             heat_content_massout               heat_content_surfwater                      Heat_PmE
             hfds                               hfevapds                                    hfibthermds               hflso
             hfrainds                           hfrunoffds                                  hfsifrazil                hfsnthermds
             hfsso                              LwLatSens                 mass_wt
             MEKE_KH                            MEKE_Le                                     MEKE_Ue                   MLD_003_max
             MLD_003_min                        MLD_003                                     mlotstmax                 mlotstmin
             mlotst                             mlotstsq                                    MSTAR                     net_heat_coupler
             net_massin                         net_massout                                 nonpenSW                  opottempmint
             opottemptend_2d                    osalttend_2d                                pbo                       prlq
             prsn                               pso                                         rlntds                    rsntds
             S_advection_xy_2d                  sfdsi                                       Sh_tendency_vert_remap_2d sob
             somint                             sos                                         sossq                     speed
             subML_N2                           T_advection_xy_2d                           Th_tendency_vert_remap_2d TKE_itidal
             TKE_tidal                          tob                       tos_max
             tos_min                            tos                                         tossq                     ustar
             wfo                                zos                                         zossq
          </variables>
        </timeSeries>

        <timeAverage source="annual" interval="10yr"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
      </component>
<!-- added by h1g 20171002 -->
      <component type="ocean_annual_rho2" source="ocean_annual_rho2" sourceGrid="ocean-tripolar" cmip="off">
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)">
        </timeSeries>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
      </component>
      <component type="ocean_annual_rho2_1x1deg" source="ocean_annual_rho2" sourceGrid="ocean-tripolar" xyInterp="180,360" cmip="off">
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)">
        </timeSeries>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
      </component>
<!-- 20171002 -->

      <!--Ocean scalars-->
      <component type="ocean_scalar_monthly" start="$(PP_START_YEAR)" source="ocean_scalar_month" sourceGrid="ocean-tripolar" cmip="on">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_scalar_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)"/>
      </component>
      
      <component type="ocean_scalar_annual"  start="$(PP_START_YEAR)" source="ocean_scalar_annual" sourceGrid="ocean-tripolar" cmip="on">
        <timeSeries freq="annual"   chunkLength="$(CHUNK_LENGTH_A)" source="ocean_scalar_annual"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_A)"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
      </component>

      <!--OCEAN REFINEDIAG-->
      <component type="ocean_month_refined"   source="ocean_month_refined" sourceGrid="ocean-tripolar" cmip="on">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month_refined"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>

      <component type="ocean_month_z_refined"   source="ocean_month_z_refined" sourceGrid="ocean-tripolar" cmip="on">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month_z_refined"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>

      <component type="ocean_month_rho2_refined"   source="ocean_month_rho2_refined" sourceGrid="ocean-tripolar" cmip="on">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month_rho2_refined"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_A)" />
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>

      <!--Ocean regions-->
      <component type="ocean_Barents_opening" source="ocean_Barents_opening" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Bering_Strait" source="ocean_Bering_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Davis_Strait" source="ocean_Davis_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Windward_Passage" source="ocean_Windward_Passage" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Denmark_Strait" source="ocean_Denmark_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Drake_Passage" source="ocean_Drake_Passage" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_English_Channel" source="ocean_English_Channel" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Faroe_Scotland" source="ocean_Faroe_Scotland" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Florida_Bahamas" source="ocean_Florida_Bahamas" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Fram_Strait" source="ocean_Fram_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Iceland_Faroe_V" source="ocean_Iceland_Faroe_V" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Iceland_Faroe_U" source="ocean_Iceland_Faroe_U" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Indonesian_Throughflow" source="ocean_Indonesian_Throughflow" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Mozambique_Channel" source="ocean_Mozambique_Channel" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Pacific_undercurrent" source="ocean_Pacific_undercurrent" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Taiwan_Luzon" source="ocean_Taiwan_Luzon" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Agulhas_section" source="ocean_Agulhas_section" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Gibraltar_Strait" source="ocean_Gibraltar_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Iceland_Norway" source="ocean_Iceland_Norway" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>

      <!--ICE-->      
      <component type="ice"  start="$(PP_START_YEAR)"  source="ice_month"  sourceGrid="ocean-tripolar" cmip="on">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month">
	   <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/tools/analysis/Krasting-SeaIce.csh"/>
           <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(AWG_INPUT_HOME)/analysis/stub/seaice_units.csh -c ice"/>
           <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(AWG_INPUT_HOME)/analysis/stub/sivol.csh -c ice"/>
	</timeSeries>   
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month">
           <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(NB_ROOT)/mom6/tools/analysis/Krasting-SeaIce.csh"/>
           <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(AWG_INPUT_HOME)/analysis/stub/seaice_units.csh -c ice"/>
           <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(AWG_INPUT_HOME)/analysis/stub/sivol.csh -c ice"/>
        </timeSeries>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
	  
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
      </component>

      <component type="ice_1x1deg"  source="ice_month" sourceGrid="ocean-tripolar" xyInterp="180,360" cmip="on">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)">
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(AWG_INPUT_HOME)/analysis/stub/seaice_units.csh -c ice"/>
        <analysis switch="$(ANALYSIS_SWITCH)" cumulative="no" script="$(AWG_INPUT_HOME)/analysis/stub/sivol.csh -c ice"/>
        </timeSeries>

        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>

     </postProcess>
   </freInclude>

  <freInclude name="abiotic_postprocess">
      <postProcess> 
      <component type="ocean_abiotic_month" start="$(PP_START_YEAR)" source="ocean_abiotic" sourceGrid="ocean-tripolar" cmip="off">
         <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
         <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>
     </postProcess>
  </freInclude>
 
  <freInclude name="abiotic_postprocess_1x1deg">
      <postProcess> 
      <component type="ocean_abiotic_month_1x1deg" xyInterp="180,360" start="$(PP_START_YEAR)" source="ocean_abiotic" sourceGrid="ocean-tripolar" cmip="on">
         <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
         <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>
     </postProcess>
  </freInclude>
 
  <freInclude name="abiotic_z_postprocess">
      <postProcess> 
      <component type="ocean_abiotic_z" start="$(PP_START_YEAR)" source="ocean_abiotic_z" sourceGrid="ocean-tripolar" cmip="off">
         <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
         <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>
     </postProcess>
  </freInclude>

  <freInclude name="abiotic_z_postprocess_1x1deg">
      <postProcess> 
      <component type="ocean_abiotic_z_1x1deg" xyInterp="180,360" start="$(PP_START_YEAR)" source="ocean_abiotic_z" sourceGrid="ocean-tripolar" cmip="on">
         <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
         <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>
     </postProcess>
  </freInclude>

  <freInclude name="inert_postprocess">
      <postProcess> 
      <component type="ocean_inert_month" start="$(PP_START_YEAR)" source="ocean_inert" sourceGrid="ocean-tripolar" cmip="off">
         <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
         <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>
     </postProcess>
  </freInclude>
 
  <freInclude name="inert_postprocess_1x1deg">
      <postProcess> 
      <component type="ocean_inert_month_1x1deg" xyInterp="180,360" start="$(PP_START_YEAR)" source="ocean_inert" sourceGrid="ocean-tripolar" cmip="on">
         <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
         <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>
     </postProcess>
  </freInclude>
 

  <freInclude name="inert_z_postprocess">
      <postProcess> 
      <component type="ocean_inert_z" start="$(PP_START_YEAR)" source="ocean_inert_z" sourceGrid="ocean-tripolar" cmip="off">
         <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
         <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>
     </postProcess>
  </freInclude>

  <freInclude name="inert_z_postprocess_1x1deg">
      <postProcess> 
      <component type="ocean_inert_z_1x1deg" xyInterp="180,360" start="$(PP_START_YEAR)" source="ocean_inert_z" sourceGrid="ocean-tripolar" cmip="on">
         <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
         <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>
     </postProcess>
  </freInclude>

  <freInclude name="BLING_postprocess">
      <postProcess> 
      <component type="ocean_bling_1x1deg" start="$(PP_START_YEAR)" source="ocean_bling" sourceGrid="ocean-tripolar" xyInterp="180,360" cmip="off">
         <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
      </component>

      <component type="ocean_bling_cmip6_omip_sfc_1x1deg" start="$(PP_START_YEAR)" source="ocean_bling_cmip6_omip_sfc" sourceGrid="ocean-tripolar" xyInterp="180,360" cmip="off">
         <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
      </component>

      <component type="ocean_bling_cmip6_omip_2d_1x1deg" start="$(PP_START_YEAR)" source="ocean_bling_cmip6_omip_2d" sourceGrid="ocean-tripolar" xyInterp="180,360" cmip="on">
         <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
      </component>

      <component type="ocean_bling_cmip6_omip_tracers_month_z_1x1deg" start="$(PP_START_YEAR)" source="ocean_bling_cmip6_omip_tracers_month_z" sourceGrid="ocean-tripolar" xyInterp="180,360" cmip="on">
         <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_A)"/>
      </component>

      <component type="ocean_bling_cmip6_omip_tracers_year_z_1x1deg" start="$(PP_START_YEAR)" source="ocean_bling_cmip6_omip_tracers_year_z" sourceGrid="ocean-tripolar" xyInterp="180,360" cmip="off">
         <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>

      <component type="ocean_bling_cmip6_omip_rates_year_z_1x1deg" start="$(PP_START_YEAR)" source="ocean_bling_cmip6_omip_rates_year_z" sourceGrid="ocean-tripolar" xyInterp="180,360" cmip="on">
         <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
         <timeAverage source="annual"  interval="$(CHUNK_LENGTH_A)"/>
      </component>

     </postProcess>
  </freInclude>

  <freInclude name="ocean_regions">
      <postProcess> 
      <!--Ocean regions-->
      <component type="ocean_Barents_opening" source="ocean_Barents_opening" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Bering_Strait" source="ocean_Bering_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Davis_Strait" source="ocean_Davis_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Windward_Passage" source="ocean_Windward_Passage" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Denmark_Strait" source="ocean_Denmark_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Drake_Passage" source="ocean_Drake_Passage" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_English_Channel" source="ocean_English_Channel" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Faroe_Scotland" source="ocean_Faroe_Scotland" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Florida_Bahamas" source="ocean_Florida_Bahamas" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Fram_Strait" source="ocean_Fram_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Iceland_Faroe_V" source="ocean_Iceland_Faroe_V" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Iceland_Faroe_U" source="ocean_Iceland_Faroe_U" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Indonesian_Throughflow" source="ocean_Indonesian_Throughflow" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Mozambique_Channel" source="ocean_Mozambique_Channel" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Pacific_undercurrent" source="ocean_Pacific_undercurrent" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Taiwan_Luzon" source="ocean_Taiwan_Luzon" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Agulhas_section" source="ocean_Agulhas_section" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Gibraltar_Strait" source="ocean_Gibraltar_Strait" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_Iceland_Norway" source="ocean_Iceland_Norway" sourceGrid="ocean-tripolar">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="monthly" averageOf="daily" chunkLength="$(CHUNK_LENGTH_B)"/>
      </component>
    </postProcess>
  </freInclude>
</experimentSuite>
